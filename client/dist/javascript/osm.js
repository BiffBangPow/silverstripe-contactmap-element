(()=>{"use strict";const t=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}},M="propertychange",L=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};function j(t,e){return e<t?1:t<e?-1:0}function T(e,i,n){var s=e.length;if(e[0]<=i)return 0;if(i<=e[s-1])return s-1;{let t;if(0<n){for(t=1;t<s;++t)if(e[t]<i)return t-1}else if(n<0){for(t=1;t<s;++t)if(e[t]<=i)return t}else for(t=1;t<s;++t){if(e[t]==i)return t;if(e[t]<i)return"function"==typeof n?0<n(i,e[t-1],e[t])?t-1:t:e[t-1]-i<i-e[t]?t-1:t}return s-1}}function F(e,i){var n=e.length;if(n===i.length){for(let t=0;t<n;t++)if(e[t]!==i[t])return;return 1}}function A(){return!0}function z(){return!1}function O(){}function D(t){for(const e in t)delete t[e]}const k=class extends L{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){var i;t&&e&&((i=(i=this.listeners_||(this.listeners_={}))[t]||(i[t]=[])).includes(e)||i.push(e))}dispatchEvent(e){var n="string"==typeof e,s=n?e:e.type,r=this.listeners_&&this.listeners_[s];if(r){var o=n?new t(e):e,n=(o.target||(o.target=this.eventTarget_||this),this.dispatching_||(this.dispatching_={})),e=this.pendingRemovals_||(this.pendingRemovals_={});let i;s in n||(n[s]=0,e[s]=0),++n[s];for(let t=0,e=r.length;t<e;++t)if(!1===(i="handleEvent"in r[t]?r[t].handleEvent(o):r[t].call(this,o))||o.propagationStopped){i=!1;break}if(0==--n[s]){let t=e[s];for(delete e[s];t--;)this.removeEventListener(s,O);delete n[s]}return i}}disposeInternal(){this.listeners_&&D(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return!!this.listeners_&&(t?t in this.listeners_:0<Object.keys(this.listeners_).length)}removeEventListener(t,e){var i=this.listeners_&&this.listeners_[t];i&&-1!==(e=i.indexOf(e))&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[e]=O,++this.pendingRemovals_[t]):(i.splice(e,1),0===i.length&&delete this.listeners_[t]))}},o="change",U="contextmenu",V="click",W="keydown",Y="keypress",q="touchmove",B="wheel";function r(t,e,i,n,s){if(n&&n!==t&&(i=i.bind(n)),s){const n=i;i=function(){t.removeEventListener(e,i),n.apply(this,arguments)}}n={target:t,type:e,listener:i};return t.addEventListener(e,i),n}function H(t,e,i,n){return r(t,e,i,n,!0)}function a(t){t&&t.target&&(t.target.removeEventListener(t.type,t.listener),D(t))}class Q extends k{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(o)}getRevision(){return this.revision_}onInternal(e,i){if(Array.isArray(e)){var n=e.length,s=new Array(n);for(let t=0;t<n;++t)s[t]=r(this,e[t],i);return s}return r(this,e,i)}onceInternal(e,i){let n;if(Array.isArray(e)){var s=e.length;n=new Array(s);for(let t=0;t<s;++t)n[t]=H(this,e[t],i)}else n=H(this,e,i);return i.ol_key=n}unInternal(i,n){var t=n.ol_key;if(t){var s=t;if(Array.isArray(s))for(let t=0,e=s.length;t<e;++t)a(s[t]);else a(s)}else if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)this.removeEventListener(i[t],n);else this.removeEventListener(i,n)}}var $=Q;function l(){throw new Error("Unimplemented abstract method.")}let J=0;function N(t){return t.ol_uid||(t.ol_uid=String(++J))}class tt extends t{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}const e=class extends ${constructor(t){super(),this.on,this.once,this.un,N(this),this.values_=null,void 0!==t&&this.setProperties(t)}get(t){let e;return e=this.values_&&this.values_.hasOwnProperty(t)?this.values_[t]:e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}hasProperties(){return!!this.values_}notify(t,e){var i="change:"+t;this.hasListener(i)&&this.dispatchEvent(new tt(i,t,e)),i=M,this.hasListener(i)&&this.dispatchEvent(new tt(i,t,e))}addChangeListener(t,e){this.addEventListener("change:"+t,e)}removeChangeListener(t,e){this.removeEventListener("change:"+t,e)}set(t,e,i){var n=this.values_||(this.values_={});if(i)n[t]=e;else{const i=n[t];i!==(n[t]=e)&&this.notify(t,i)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){var i;this.values_&&t in this.values_&&(i=this.values_[t],delete this.values_[t],function(t){let e;for(e in t)return;return!e}(this.values_)&&(this.values_=null),e||this.notify(t,i))}},et={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection"};class it extends Error{constructor(t){var e=et[t];super(e),this.code=t,this.name="AssertionError",this.message=e}}const nt=it,h="add",d="remove",st="length";class rt extends t{constructor(t,e,i){super(t),this.element=e,this.index=i}}const u=class extends e{constructor(t,e){if(super(),this.on,this.once,this.un,this.unique_=!!(e=e||{}).unique,this.array_=t||[],this.unique_)for(let t=0,e=this.array_.length;t<e;++t)this.assertUnique_(this.array_[t],t);this.updateLength_()}clear(){for(;0<this.getLength();)this.pop()}extend(i){for(let t=0,e=i.length;t<e;++t)this.push(i[t]);return this}forEach(i){var n=this.array_;for(let t=0,e=n.length;t<e;++t)i(n[t],t,n)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(st)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new rt(h,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(i){var n=this.array_;for(let t=0,e=n.length;t<e;++t)if(n[t]===i)return this.removeAt(t)}removeAt(t){var e;if(!(t<0||t>=this.getLength()))return e=this.array_[t],this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new rt(d,e,t)),e}setAt(t,e){if(t>=this.getLength())this.insertAt(t,e);else{if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);var i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new rt(d,i,t)),this.dispatchEvent(new rt(h,e,t))}}updateLength_(){this.set(st,this.array_.length)}assertUnique_(i,n){for(let t=0,e=this.array_.length;t<e;++t)if(this.array_[t]===i&&t!==n)throw new nt(58)}},i="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",ot=i.includes("firefox"),at=(!i.includes("safari")||i.includes("chrom")||i.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(i),i.includes("webkit")&&!i.includes("edge")),lt=i.includes("macintosh"),ht="undefined"!=typeof devicePixelRatio?devicePixelRatio:1,dt="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,ut="undefined"!=typeof Image&&Image.prototype.decode,ct=function(){let t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(t){}return t}();function c(t,e){if(!t)throw new nt(e)}function Z(t,e){var i=e[0],n=e[1];return e[0]=t[0]*i+t[2]*n+t[4],e[1]=t[1]*i+t[3]*n+t[5],e}function gt(t,e,i,n,s,r,o,a){var l=Math.sin(r),r=Math.cos(r);return t[0]=n*r,t[1]=s*l,t[2]=-n*l,t[3]=s*r,t[4]=o*n*r-a*n*l+e,t[5]=o*s*l+a*s*r+i,t}function _t(t,e){var i=e[0]*e[3]-e[1]*e[2],n=(c(0!=i,32),e[0]),s=e[1],r=e[2],o=e[3],a=e[4],e=e[5];t[0]=o/i,t[1]=-s/i,t[2]=-r/i,t[3]=n/i,t[4]=(r*e-o*a)/i,t[5]=-(n*e-s*a)/i}let pt;function mt(i){var n=[1/0,1/0,-1/0,-1/0];for(let t=0,e=i.length;t<e;++t)wt(n,i[t]);return n}function vt(t,e,i){e=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,i=i<t[1]?t[1]-i:t[3]<i?i-t[3]:0;return e*e+i*i}function ft(t,e){return yt(t,e[0],e[1])}function yt(t,e,i){return t[0]<=e&&e<=t[2]&&t[1]<=i&&i<=t[3]}function xt(t,e){var i=t[0],n=t[1],s=t[2],t=t[3],r=e[0],e=e[1];let o=0;return r<i?o|=16:s<r&&(o|=4),e<n?o|=8:t<e&&(o|=2),o=0===o?1:o}function g(t,e,i,n,s){return s?(s[0]=t,s[1]=e,s[2]=i,s[3]=n,s):[t,e,i,n]}function Ct(t){return g(1/0,1/0,-1/0,-1/0,t)}function Et(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function wt(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function Tt(t,e,i,n,s){for(;i<n;i+=s)r=t,o=e[i],a=e[i+1],r[0]=Math.min(r[0],o),r[1]=Math.min(r[1],a),r[2]=Math.max(r[2],o),r[3]=Math.max(r[3],a);var r,o,a;return t}function Rt(t,e){var i=e(Pt(t));return i||e(St(t))||e(At(t))||e(G(t))}function bt(t){let e=0;return e=Ot(t)?e:X(t)*K(t)}function Pt(t){return[t[0],t[1]]}function St(t){return[t[2],t[1]]}function It(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Mt(t,e,i,n,s){var[t,e,i,n,r,o,a,l]=Lt(t,e,i,n);return g(Math.min(t,i,r,a),Math.min(e,n,o,l),Math.max(t,i,r,a),Math.max(e,n,o,l),s)}function Lt(t,e,i,n){var s=e*n[0]/2,e=e*n[1]/2,n=Math.cos(i),i=Math.sin(i),r=s*n,s=s*i,n=e*n,e=e*i,i=t[0],t=t[1];return[i-r+e,t-s-n,i-r-e,t-s+n,i+r-e,t+s+n,i+r+e,t+s-n,i-r+e,t-s-n]}function K(t){return t[3]-t[1]}function Ft(t,e,i){i=i||[1/0,1/0,-1/0,-1/0];return zt(t,e)?(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]):Ct(i),i}function G(t){return[t[0],t[3]]}function At(t){return[t[2],t[3]]}function X(t){return t[2]-t[0]}function zt(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Ot(t){return t[2]<t[0]||t[3]<t[1]}function R(t,e,i){return Math.min(Math.max(t,e),i)}function w(t,e,i,n){i-=t,t=n-e;return i*i+t*t}function Dt(t){return t*Math.PI/180}function m(t,e){t%=e;return t*e<0?t+e:t}function kt(t,e){e=Math.pow(10,e);return Math.round(t*e)/e}function jt(t,e){return Math.floor(kt(t,e))}function Nt(t,e){return Math.ceil(kt(t,e))}new Array(6);const Zt=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,Kt=/^([a-z]*)$|^hsla?\(.*\)$/i,Gt=function(){const i={};let n=0;return function(t){let e;if(i.hasOwnProperty(t))e=i[t];else{if(1024<=n){let t=0;for(const e in i)0==(3&t++)&&(delete i[e],--n)}e=function(t){let e,i,n,s,r;var o,a;return Kt.exec(t)&&(t=function(t){var e=document.createElement("div");if(e.style.color=t,""===e.style.color)return"";{document.body.appendChild(e);const t=getComputedStyle(e).color;return document.body.removeChild(e),t}}(t)),Zt.exec(t)?(o=(a=t.length-1)<=4?1:2,a=4==a||8==a,e=parseInt(t.substr(1+0*o,o),16),i=parseInt(t.substr(1+o,o),16),n=parseInt(t.substr(1+2*o,o),16),s=a?parseInt(t.substr(1+3*o,o),16):255,1==o&&(e=(e<<4)+e,i=(i<<4)+i,n=(n<<4)+n,a)&&(s=(s<<4)+s),r=[e,i,n,s/255]):t.startsWith("rgba(")?Ut(r=t.slice(5,-1).split(",").map(Number)):t.startsWith("rgb(")?((r=t.slice(4,-1).split(",").map(Number)).push(1),Ut(r)):c(!1,14),r}(t),i[t]=e,++n}return e}}();function Xt(t){return Array.isArray(t)?t:Gt(t)}function Ut(t){t[0]=R(t[0]+.5|0,0,255),t[1]=R(t[1]+.5|0,0,255),t[2]=R(t[2]+.5|0,0,255),t[3]=R(t[3],0,1)}function Vt(t,e,i){return e+":"+t+":"+(i?function(n){if("string"==typeof n)return n;{let t=n[0],e=(t!=(0|t)&&(t=t+.5|0),n[1]),i=(e!=(0|e)&&(e=e+.5|0),n[2]);return i!=(0|i)&&(i=i+.5|0),"rgba("+t+","+e+","+i+","+(void 0===n[3]?1:Math.round(100*n[3])/100)+")"}}(i):"null")}const Wt=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const i in this.cache_){var e=this.cache_[i];0!=(3&t++)||e.hasListener()||(delete this.cache_[i],--this.cacheSize_)}}}get(t,e,i){t=Vt(t,e,i);return t in this.cache_?this.cache_[t]:null}set(t,e,i,n){t=Vt(t,e,i);this.cache_[t]=n,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}},Yt="opacity",qt="visible",Bt="maxResolution",Ht="minResolution",Qt="maxZoom",$t="minZoom",Jt="source",te=class extends e{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;var e=Object.assign({},t);"object"==typeof t.properties&&(delete e.properties,Object.assign(e,t.properties)),e.opacity=void 0!==t.opacity?t.opacity:1,c("number"==typeof e.opacity,64),e.visible=void 0===t.visible||t.visible,e.zIndex=t.zIndex,e.maxResolution=void 0!==t.maxResolution?t.maxResolution:1/0,e.minResolution=void 0!==t.minResolution?t.minResolution:0,e.minZoom=void 0!==t.minZoom?t.minZoom:-1/0,e.maxZoom=void 0!==t.maxZoom?t.maxZoom:1/0,this.className_=void 0!==e.className?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){var t=this.state_||{layer:this,managed:void 0===t||t},e=this.getZIndex();return t.opacity=R(Math.round(100*this.getOpacity())/100,0,1),t.visible=this.getVisible(),t.extent=this.getExtent(),t.zIndex=void 0!==e||t.managed?e:1/0,t.maxResolution=this.getMaxResolution(),t.minResolution=Math.max(this.getMinResolution(),0),t.minZoom=this.getMinZoom(),t.maxZoom=this.getMaxZoom(),this.state_=t}getLayersArray(t){return l()}getLayerStatesArray(t){return l()}getExtent(){return this.get("extent")}getMaxResolution(){return this.get(Bt)}getMinResolution(){return this.get(Ht)}getMinZoom(){return this.get($t)}getMaxZoom(){return this.get(Qt)}getOpacity(){return this.get(Yt)}getSourceState(){return l()}getVisible(){return this.get(qt)}getZIndex(){return this.get("zIndex")}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set("extent",t)}setMaxResolution(t){this.set(Bt,t)}setMinResolution(t){this.set(Ht,t)}setMaxZoom(t){this.set(Qt,t)}setMinZoom(t){this.set($t,t)}setOpacity(t){c("number"==typeof t,64),this.set(Yt,t)}setVisible(t){this.set(qt,t)}setZIndex(t){this.set("zIndex",t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}},ee="precompose",ie="rendercomplete";function ne(t,e){if(t.visible){var i=e.resolution;if(!(i<t.minResolution||i>=t.maxResolution))return(i=e.zoom)>t.minZoom&&i<=t.maxZoom}}const se=class extends te{constructor(t){var e=Object.assign({},t),e=(delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(Jt,this.handleSourcePropertyChange_),t.source||null);this.setSource(e)}getLayersArray(t){return(t=t||[]).push(this),t}getLayerStatesArray(t){return(t=t||[]).push(this.getLayerState()),t}getSource(){return this.get(Jt)||null}getRenderSource(){return this.getSource()}getSourceState(){var t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed()}handleSourcePropertyChange_(){this.sourceChangeKey_&&(a(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=r(t,o,this.handleSourceChange_,this)),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):new Promise(t=>t([]))}getData(t){return this.renderer_&&this.rendered?this.renderer_.getData(t):null}render(t,e){var i=this.getRenderer();if(i.prepareFrame(t))return this.rendered=!0,i.renderFrame(t,e)}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set("map",t)}getMapInternal(){return this.get("map")}setMap(t){this.mapPrecomposeKey_&&(a(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(a(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=r(t,ee,function(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);c(!e.some(function(t){return t.layer===i.layer}),67),e.push(i)},this),this.mapRenderKey_=r(this,o,t.render,t),this.changed())}setSource(t){this.set(Jt,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}};function re(e,i){let n=!0;for(let t=e.length-1;0<=t;--t)if(e[t]!=i[t]){n=!1;break}return n}function oe(t,e){var i=Math.cos(e),e=Math.sin(e),n=t[0]*i-t[1]*e,i=t[1]*i+t[0]*e;t[0]=n,t[1]=i}function ae(t,e){Wt.expire()}const le=class extends L{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){l()}calculateMatrices2D(t){var e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;gt(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),_t(n,i)}forEachFeatureAtCoordinate(i,n,s,t,r,o,a,l){let h;const d=n.viewState;function u(t,e,i,n){return r.call(o,e,t?i:null,n)}const c=d.projection,g=(e=i.slice(),(p=c).canWrapX()&&(m=X(p.getExtent()),p=function(t,e,i){var n=e.getExtent();let s=0;return e.canWrapX()&&(t[0]<n[0]||t[0]>n[2])&&(i=i||X(n),s=Math.floor((t[0]-n[0])/i)),s}(e,p,m))&&(e[0]-=p*m),e),_=[[0,0]];var e,p,m;if(c.canWrapX()&&t){const i=X(c.getExtent());_.push([-i,0],[i,0])}var v=n.layerStatesArray,f=v.length,y=[],x=[];for(let e=0;e<_.length;e++)for(let t=f-1;0<=t;--t){const o=v[t],c=o.layer;if(c.hasRenderer()&&ne(o,d)&&a.call(l,c)){const r=c.getRenderer(),a=c.getSource();if(r&&a){const l=a.getWrapX()?g:i,d=u.bind(null,o.managed);x[0]=l[0]+_[e][0],x[1]=l[1]+_[e][1],h=r.forEachFeatureAtCoordinate(x,n,s,d,y)}if(h)return h}}if(0!==y.length){const C=1/y.length;return y.forEach((t,e)=>t.distanceSq+=e*C),y.sort((t,e)=>t.distanceSq-e.distanceSq),y.some(t=>h=t.callback(t.feature,t.layer,t.geometry)),h}}hasFeatureAtCoordinate(t,e,i,n,s,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,i,n,A,this,s,r)}getMap(){return this.map_}renderFrame(t){l()}scheduleExpireIconCache(t){Wt.canExpireCache()&&t.postRenderFunctions.push(ae)}},he=class extends t{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}},de="ol-hidden",ue="ol-control";function ce(t,e,i,n){i=i&&i.length?i.shift():dt?new OffscreenCanvas(t||300,e||300):document.createElement("canvas");return t&&(i.width=t),e&&(i.height=e),i.getContext("2d",n)}function ge(t,e){var i=e.parentNode;i&&i.replaceChild(t,e)}function _e(t){t&&t.parentNode&&t.parentNode.removeChild(t)}new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i");const pe=new e,me=class extends le{constructor(t){super(t),this.fontChangeListenerKey_=r(pe,M,t.redrawText.bind(t)),this.element_=document.createElement("div");var e=this.element_.style,e=(e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className="ol-unselectable ol-layers",t.getViewport());e.insertBefore(this.element_,e.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){var i=this.getMap();i.hasListener(t)&&(t=new he(t,void 0,e),i.dispatchEvent(t))}disposeInternal(){a(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(n){if(n){this.calculateMatrices2D(n),this.dispatchRenderEvent(ee,n);var s=n.layerStatesArray.sort(function(t,e){return t.zIndex-e.zIndex}),r=n.viewState,o=[];let i=null;for(let t=this.children_.length=0,e=s.length;t<e;++t){var a=s[t],l=(n.layerIndex=t,a.layer),h=l.getSourceState();!ne(a,r)||"ready"!=h&&"undefined"!=h?l.unrender():(a=l.render(n,i))&&(a!==i&&(this.children_.push(a),i=a),"getDeclutter"in l)&&o.push(l)}for(let t=o.length-1;0<=t;--t)o[t].renderDeclutter(n);var e=this.element_,d=this.children_,u=e.childNodes;for(let t=0;;++t){var c=u[t],g=d[t];if(!c&&!g)break;c!==g&&(c?g?e.insertBefore(g,c):(e.removeChild(c),--t):e.appendChild(g))}this.dispatchRenderEvent("postcompose",n),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(n)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)}};class s extends t{constructor(t,e){super(t),this.layer=e}}const ve="layers";const fe=class Bn extends te{constructor(t){t=t||{};var e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(ve,this.handleLayersChanged_),i?Array.isArray(i)?i=new u(i.slice(),{unique:!0}):c("function"==typeof i.getArray,43):i=new u(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(a),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(r(t,h,this.handleLayersAdd_,this),r(t,d,this.handleLayersRemove_,this));for(const t in this.listenerKeys_)this.listenerKeys_[t].forEach(a);D(this.listenerKeys_);var i=t.getArray();for(let t=0,e=i.length;t<e;t++){var n=i[t];this.registerLayerListeners_(n),this.dispatchEvent(new s("addlayer",n))}this.changed()}registerLayerListeners_(t){var e=[r(t,M,this.handleLayerChange_,this),r(t,o,this.handleLayerChange_,this)];t instanceof Bn&&e.push(r(t,"addlayer",this.handleLayerGroupAdd_,this),r(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[N(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new s("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new s("removelayer",t.layer))}handleLayersAdd_(t){t=t.element,this.registerLayerListeners_(t),this.dispatchEvent(new s("addlayer",t)),this.changed()}handleLayersRemove_(t){var e=N(t=t.element);this.listenerKeys_[e].forEach(a),delete this.listenerKeys_[e],this.dispatchEvent(new s("removelayer",t)),this.changed()}getLayers(){return this.get(ve)}setLayers(i){var t=this.getLayers();if(t){const i=t.getArray();for(let t=0,e=i.length;t<e;++t)this.dispatchEvent(new s("removelayer",i[t]))}this.set(ve,i)}getLayersArray(e){return e=void 0!==e?e:[],this.getLayers().forEach(function(t){t.getLayersArray(e)}),e}getLayerStatesArray(t){const i=void 0!==t?t:[],n=i.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(i)});var s=this.getLayerState();let r=s.zIndex;t||void 0!==s.zIndex||(r=0);for(let t=n,e=i.length;t<e;t++){const n=i[t];n.opacity*=s.opacity,n.visible=n.visible&&s.visible,n.maxResolution=Math.min(n.maxResolution,s.maxResolution),n.minResolution=Math.max(n.minResolution,s.minResolution),n.minZoom=Math.max(n.minZoom,s.minZoom),n.maxZoom=Math.min(n.maxZoom,s.maxZoom),void 0!==s.extent&&(void 0!==n.extent?n.extent=Ft(n.extent,s.extent):n.extent=s.extent),void 0===n.zIndex&&(n.zIndex=r)}return i}getSourceState(){return"ready"}},_=class extends t{constructor(t,e,i){super(t),this.map=e,this.frameState=void 0!==i?i:null}},n=class extends _{constructor(t,e,i,n,s,r){super(t,e,s),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=void 0!==n&&n,this.activePointers=r}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}},p={SINGLECLICK:"singleclick",CLICK:V,DBLCLICK:"dblclick",POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ye="pointerdown",xe=class extends k{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=void 0===e?1:e,this.down_=null;t=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=t,this.pointerdownListenerKey_=r(t,ye,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=r(t,"pointermove",this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(q,this.boundHandleTouchMove_,!!ct&&{passive:!1})}emulateClick_(e){var t=new n(p.CLICK,this.map_,e);this.dispatchEvent(t),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,t=new n(p.DBLCLICK,this.map_,e),this.dispatchEvent(t)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var t=new n(p.SINGLECLICK,this.map_,e);this.dispatchEvent(t)}.bind(this),250)}updateActivePointers_(t){var e=t,t=e.pointerId;if(e.type==p.POINTERUP||e.type==p.POINTERCANCEL){delete this.trackedTouches_[t];for(const t in this.trackedTouches_)if(this.trackedTouches_[t].target!==e.target){delete this.trackedTouches_[t];break}}else e.type!=p.POINTERDOWN&&e.type!=p.POINTERMOVE||(this.trackedTouches_[t]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);var e=new n(p.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_.length&&(this.dragListenerKeys_.forEach(a),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return 0===t.button}handlePointerDown_(t){this.emulateClicks_=0===this.activePointers_.length,this.updateActivePointers_(t);const e=new n(p.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.down_={};for(const e in t){var i=t[e];this.down_[e]="function"==typeof i?O:i}if(0===this.dragListenerKeys_.length){const t=this.map_.getOwnerDocument();this.dragListenerKeys_.push(r(t,p.POINTERMOVE,this.handlePointerMove_,this),r(t,p.POINTERUP,this.handlePointerUp_,this),r(this.element_,p.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==t&&this.dragListenerKeys_.push(r(this.element_.getRootNode(),p.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){this.isMoving_(t)&&(this.updateActivePointers_(t),this.dragging_=!0,t=new n(p.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_),this.dispatchEvent(t))}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new n(p.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){var e=this.originalPointerMoveEvent_;e&&!e.defaultPrevented||"boolean"==typeof t.cancelable&&!0!==t.cancelable||t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(a(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(q,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(a(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(a),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}},Ce="postrender",Ee="loadstart",we="loadend",Te="layergroup",Re="size",be="target",Pe="view",Se=class extends class{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,D(this.queuedElements_)}dequeue(){var t=this.elements_,e=this.priorities_,i=t[0],t=(1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0)),this.keyFunction_(i));return delete this.queuedElements_[t],i}enqueue(t){c(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=1/0&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(t){return 2*t+1}getRightChildIndex_(t){return 2*t+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;0<=t;t--)this.siftUp_(t)}isEmpty(){return 0===this.elements_.length}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,s=e[t],r=i[t],o=t;for(;t<n>>1;){const s=this.getLeftChildIndex_(t),r=this.getRightChildIndex_(t),o=r<n&&i[r]<i[s]?r:s;e[t]=e[o],i[t]=i[o],t=o}e[t]=s,i[t]=r,this.siftDown_(o,t)}siftDown_(t,e){for(var i=this.elements_,n=this.priorities_,s=i[e],r=n[e];t<e;){const t=this.getParentIndex_(e);if(!(n[t]>r))break;i[e]=i[t],n[e]=n[t],e=t}i[e]=s,n[e]=r}reprioritize(){var t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;var s=e.length;let r,o,a;for(o=0;o<s;++o)(a=t(r=e[o]))==1/0?delete this.queuedElements_[this.keyFunction_(r)]:(i[n]=a,e[n++]=r);e.length=n,i.length=n,this.heapify_()}}{constructor(e,t){super(function(t){return e.apply(null,t)},function(t){return t[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=t,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){var e=super.enqueue(t);return e&&t[0].addEventListener(o,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){var e=t.target,i=e.getState();if(2===i||3===i||4===i){3!==i&&e.removeEventListener(o,this.boundHandleTileChange_);const t=e.getKey();t in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[t],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i,n,s=0;for(;this.tilesLoading_<t&&s<e&&0<this.getCount();)n=(i=this.dequeue()[0]).getKey(),0!==i.getState()||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++s,i.load())}},v={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},Ie={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937},Me=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Ie[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}},Le=6378137,f=Math.PI*Le,Fe=[-f,-f,f,f],Ae=[-180,-85,180,85],ze=Le*Math.log(Math.tan(Math.PI/2));class Oe extends Me{constructor(t){super({code:t,units:"m",extent:Fe,global:!0,worldExtent:Ae,getPointResolution:function(t,e){return t/Math.cosh(e[1]/Le)}})}}var y=[new Oe("EPSG:3857"),new Oe("EPSG:102100"),new Oe("EPSG:102113"),new Oe("EPSG:900913"),new Oe("http://www.opengis.net/def/crs/EPSG/0/3857"),new Oe("http://www.opengis.net/gml/srs/epsg.xml#3857")];const De=[-180,-90,180,90],ke=6378137*Math.PI/180;class x extends Me{constructor(t,e){super({code:t,units:"degrees",extent:De,axisOrientation:e,global:!0,metersPerUnit:ke,worldExtent:De})}}var je,Ne,Ze,C=[new x("CRS:84"),new x("EPSG:4326","neu"),new x("urn:ogc:def:crs:OGC:1.3:CRS84"),new x("urn:ogc:def:crs:OGC:2:84"),new x("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new x("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new x("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Ke={},Ge={};function Xe(t,e,i){t=t.getCode(),e=e.getCode();t in Ge||(Ge[t]={}),Ge[t][e]=i}function Ue(t,e,i){i=i||6371008.8;var n=Dt(t[1]),s=Dt(e[1]),r=(s-n)/2,e=Dt(e[0]-t[0])/2,t=Math.sin(r)*Math.sin(r)+Math.sin(e)*Math.sin(e)*Math.cos(n)*Math.cos(s);return 2*i*Math.atan2(Math.sqrt(t),Math.sqrt(1-t))}let Ve=!0;function We(i,n,t){if(void 0!==n)for(let t=0,e=i.length;t<e;++t)n[t]=i[t];else n=i.slice();return n}function Ye(i,n,t){if(void 0!==n&&i!==n){for(let t=0,e=i.length;t<e;++t)n[t]=i[t];i=n}return i}function qe(t){var e,i;e=t.getCode(),i=t,Ke[e]=i,Xe(t,t,We)}function E(t){return"string"==typeof t?Ke[e=t]||Ke[e.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:t||null;var e}function Be(t,e,i,n){let s;const r=(t=E(t)).getPointResolutionFunc();if(r){if(s=r(e,i),n&&n!==t.getUnits()){const e=t.getMetersPerUnit();e&&(s=s*e/Ie[n])}}else{const r=t.getUnits();var o;"degrees"==r&&!n||"degrees"==n?s=e:(o=Je(t,E("EPSG:4326")),s=o===Ye&&"degrees"!==r?e*t.getMetersPerUnit():(Ue((o=o(o=[i[0]-e/2,i[1],i[0]+e/2,i[1],i[0],i[1]-e/2,i[0],i[1]+e/2],o,2)).slice(0,2),o.slice(2,4))+Ue(o.slice(4,6),o.slice(6,8)))/2,void 0!==(i=n?Ie[n]:t.getMetersPerUnit())&&(s/=i))}return s}function He(t){t.forEach(qe),t.forEach(function(e){t.forEach(function(t){e!==t&&Xe(e,t,We)})})}function Qe(t,e){return t?"string"==typeof t?E(t):t:E(e)}function $e(t,e){var i;return t===e||(i=t.getUnits()===e.getUnits(),(t.getCode()===e.getCode()||Je(t,e)===We)&&i)}function Je(t,e){let i=function(t,e){let i;return i=t in Ge&&e in Ge[t]?Ge[t][e]:i}(t.getCode(),e.getCode());return i=i||Ye}function ti(t,e){return Je(E(t),E(e))}function ei(t){return t}function b(t){return Ve&&!re(t,[0,0])&&-180<=t[0]&&t[0]<=180&&-90<=t[1]&&t[1]<=90&&(Ve=!1,console.warn("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),t}function ii(t){return t}function ni(g,_,p){return function(o,a,l,h,d){if(o){if(!a&&!_)return o;var u=_?0:l[0]*a,l=_?0:l[1]*a,c=d?d[0]:0,d=d?d[1]:0;let t=g[0]+u/2+c,e=g[2]-u/2+c,i=g[1]+l/2+d,n=g[3]-l/2+d,s=(t>e&&(t=(e+t)/2,e=t),i>n&&(i=(n+i)/2,n=i),R(o[0],t,e)),r=R(o[1],i,n);if(h&&p&&a){const g=30*a;s+=-g*Math.log(1+Math.max(0,t-o[0])/g)+g*Math.log(1+Math.max(0,o[0]-e)/g),r+=-g*Math.log(1+Math.max(0,i-o[1])/g)+g*Math.log(1+Math.max(0,o[1]-n)/g)}return[s,r]}}}function si(t){return t}function ri(t,e,i,n){var s=X(e)/i[0],e=K(e)/i[1];return n?Math.min(t,Math.max(s,e)):Math.min(t,Math.min(s,e))}function oi(t,e,i){let n=Math.min(t,e);return n*=Math.log(1+50*Math.max(0,t/e-1))/50+1,i&&(n=Math.max(n,i),n/=Math.log(1+50*Math.max(0,i/t-1))/50+1),R(n,i/2,2*e)}function ai(s,r,o,a,l){return o=void 0===o||o,function(t,e,i,n){if(void 0!==t){const e=a?ri(s,a,i,l):s;return o&&n?oi(t,e,r):R(t,r,e)}}}function li(t){return void 0!==t?0:void 0}function hi(t){return void 0!==t?t:void 0}function di(t){return Math.pow(t,3)}function ui(t){return 1-di(1-t)}function ci(t){return 3*t*t-2*t*t*t}function gi(t){return t}He(y),He(C),je=y,Ne=function(i,n,t){var s=i.length;t=1<t?t:2,void 0===n&&(n=2<t?i.slice():new Array(s));for(let e=0;e<s;e+=t){n[e]=f*i[e]/180;let t=Le*Math.log(Math.tan(Math.PI*(+i[e+1]+90)/360));t>ze?t=ze:t<-ze&&(t=-ze),n[e+1]=t}return n},Ze=function(e,i,n){var s=e.length;n=1<n?n:2,void 0===i&&(i=2<n?e.slice():new Array(s));for(let t=0;t<s;t+=n)i[t]=180*e[t]/f,i[t+1]=360*Math.atan(Math.exp(e[t+1]/Le))/Math.PI-90;return i},C.forEach(function(e){je.forEach(function(t){Xe(e,t,Ne),Xe(t,e,Ze)})});const _i=[1,0,0,1,0,0],pi=class extends e{constructor(){super(),this.extent_=[1/0,1/0,-1/0,-1/0],this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=function(){let e,i,n,s=!1;return function(){var t=Array.prototype.slice.call(arguments);return s&&this===n&&F(t,i)||(s=!0,n=this,i=t,e=function(t,e,i){if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)}.apply(this,arguments)),e}}()}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return l()}closestPointXY(t,e,i,n){return l()}containsXY(t,e){var i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return this.closestPointXY(t[0],t[1],e=e||[NaN,NaN],1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return l()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const t=this.computeExtent(this.extent_);(isNaN(t[0])||isNaN(t[1]))&&Ct(t),this.extentRevision_=this.getRevision()}return e=this.extent_,(t=t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):e;var e}rotate(t,e){l()}scale(t,e,i){l()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return l()}getType(){return l()}applyTransform(t){l()}intersectsExtent(t){return l()}translate(t,e){l()}transform(t,d){const u=E(t),e="tile-pixels"==u.getUnits()?function(t,i,n){var e=u.getExtent(),s=u.getWorldExtent(),e=K(s)/K(e);gt(_i,s[0],s[3],e,-e,0,0,0);{var r=t,o=t.length,a=n,l=_i,h=i;h=h||[];let e=0;for(let t=0;t<o;t+=a){const o=r[t],a=r[t+1];h[e++]=l[0]*o+l[2]*a+l[4],h[e++]=l[1]*o+l[3]*a+l[5]}h&&h.length!=e&&(h.length=e)}return ti(u,d)(t,i,n)}:ti(u,d);return this.applyTransform(e),this}};function mi(t){let e;return"XY"==t?e=2:"XYZ"==t||"XYM"==t?e=3:"XYZM"==t&&(e=4),e}y=class extends pi{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(t){return e=this.flatCoordinates,i=this.flatCoordinates.length,n=this.stride,Tt(Ct(t),e,0,i,n);var e,i,n}getCoordinates(){return l()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){var e;return this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance?this:(e=this.getSimplifiedGeometryInternal(t)).getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=mi(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){l()}setLayout(t,e,i){let n;if(t)n=mi(t);else{for(let t=0;t<i;++t){if(0===e.length)return this.layout="XY",void(this.stride=2);e=e[0]}t=function(t){let e;return 2==t?e="XY":3==t?e="XYZ":4==t&&(e="XYZM"),e}(n=e.length)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){var n=this.getFlatCoordinates();if(n){var s=this.getStride();{var r=n;var o=n.length;var a=s;var l=t;s=e;var h=n;h=h||[];var d=Math.cos(l),u=Math.sin(l),c=s[0],g=s[1];let i=0;for(let e=0;e<o;e+=a){const o=r[e]-c,l=r[e+1]-g;h[i++]=c+o*d-l*u,h[i++]=g+o*u+l*d;for(let t=e+2;t<e+a;++t)h[i++]=r[t]}h&&h.length!=i&&(h.length=i)}this.changed()}}scale(t,e,n){void 0===e&&(e=t),n=n||It(this.getExtent());var s=this.getFlatCoordinates();if(s){var r=this.getStride();{var o=s;var a=s.length;var l=r;var h=t;var d=e;var u=n;var c=s;c=c||[];var g=u[0],_=u[1];let i=0;for(let e=0;e<a;e+=l){const a=o[e]-g,u=o[e+1]-_;c[i++]=g+h*a,c[i++]=_+d*u;for(let t=e+2;t<e+l;++t)c[i++]=o[t]}c&&c.length!=i&&(c.length=i)}this.changed()}}translate(t,e){var n=this.getFlatCoordinates();if(n){var s=this.getStride();{var r=n;var o=n.length;var a=s;var l=t;var h=e;var d=n;d=d||[];let i=0;for(let e=0;e<o;e+=a){d[i++]=r[e]+l,d[i++]=r[e+1]+h;for(let t=e+2;t<e+a;++t)d[i++]=r[t]}d&&d.length!=i&&(d.length=i)}this.changed()}}};function vi(e,i,n,s,t,r,o){var a,l,h=e[i],d=e[i+1],u=e[n]-h,c=e[n+1]-d;let g;if(0==u&&0==c)g=i;else{var _=((t-h)*u+(r-d)*c)/(u*u+c*c);if(1<_)g=n;else{if(0<_){for(let t=0;t<s;++t)o[t]=(a=e[i+t],l=e[n+t],a+_*(l-a));return o.length=s}g=i}}for(let t=0;t<s;++t)o[t]=e[g+t];o.length=s}function fi(t,e,i,n,s){let r=t[e],o=t[e+1];for(e+=n;e<i;e+=n){const i=t[e],n=t[e+1],a=w(r,o,i,n);s<a&&(s=a),r=i,o=n}return s}function yi(n,s,r,o,a,l,h,d,u,c,g){if(s!=r){let e,i;if(0===a){if((i=w(h,d,n[s],n[s+1]))<c){for(e=0;e<o;++e)u[e]=n[s+e];return u.length=o,i}}else{g=g||[NaN,NaN];let t=s+o;for(;t<r;)if(vi(n,t-o,t,o,h,d,g),(i=w(h,d,g[0],g[1]))<c){for(c=i,e=0;e<o;++e)u[e]=g[e];u.length=o,t+=o}else t+=o*Math.max((Math.sqrt(i)-Math.sqrt(c))/a|0,1);if(l&&(vi(n,r-o,s,o,h,d,g),(i=w(h,d,g[0],g[1]))<c)){for(c=i,e=0;e<o;++e)u[e]=g[e];u.length=o}}}return c}function xi(i,n,s,r){for(let t=0,e=s.length;t<e;++t){var o=s[t];for(let t=0;t<r;++t)i[n++]=o[t]}return n}function Ci(t,e){return e*Math.round(t/e)}function Ei(e,i,n,s,r){r=void 0!==r?r:[];let o=0;for(let t=i;t<n;t+=s)r[o++]=e.slice(t,t+s);return r.length=o,r}function wi(t,e,i,n){let s=0,r=t[i-n],o=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];s+=o*i-r*n,r=i,o=n}return s/2}const Ti=class Hn extends y{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===e||Array.isArray(t[0])?this.setCoordinates(t,e):this.setFlatCoordinates(e,t)}clone(){return new Hn(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<vt(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(fi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),yi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return wi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Ei(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){var e=[];return e.length=function(n,s,r,o,t,a,e){const l=(r-s)/o;if(l<3)for(;s<r;s+=o)a[e++]=n[s],a[e++]=n[s+1];else{var h,d,u,c,g,_,p,m,v,f=new Array(l),y=(f[0]=1,f[l-1]=1,[s,r-o]);let i=0;for(;0<y.length;){const r=y.pop(),a=y.pop();let e=0;const l=n[a],x=n[a+1],C=n[r],E=n[r+1];for(let t=a+o;t<r;t+=o){h=n[t],d=n[t+1],u=l,v=m=p=void 0,v=(_=E)-(c=x),0==(m=(g=C)-u)&&0==v||(1<(p=((h-u)*m+(d-c)*v)/(m*m+v*v))?(u=g,c=_):0<p&&(u+=m*p,c+=v*p));const r=w(h,d,u,c);r>e&&(i=t,e=r)}e>t&&(f[(i-s)/o]=1,a+o<i&&y.push(a,i),i+o<r)&&y.push(i,r)}for(let t=0;t<l;++t)f[t]&&(a[e++]=n[s+t*o],a[e++]=n[s+t*o+1])}return e}(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Hn(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=xi(this.flatCoordinates,0,t,this.stride),this.changed()}};const Ri=class Qn extends y{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){var t=new Qn(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(e,t,i,n){var s=this.flatCoordinates;if((t=w(e,t,s[0],s[1]))<n){const e=this.stride;for(let t=0;t<e;++t)i[t]=s[t];return i.length=e,t}return n}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(t){return e=this.flatCoordinates,i=e[0],e=e[1],g(i,e,i,e,t);var e,i}getType(){return"Point"}intersectsExtent(t){return yt(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=function(i,n,s){for(let t=0,e=s.length;t<e;++t)i[n++]=s[t];return n}(this.flatCoordinates,0,t,this.stride),this.changed()}};function P(t,e,i,n,s,r){let o=0,a=t[i-n],l=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];l<=r?n>r&&0<(i-a)*(r-l)-(s-a)*(n-l)&&o++:n<=r&&(i-a)*(r-l)-(s-a)*(n-l)<0&&o--,a=i,l=n}return 0!==o}function bi(i,t,n,s,r,o){if(0===n.length)return!1;if(!P(i,t,n[0],s,r,o))return!1;for(let t=1,e=n.length;t<e;++t)if(P(i,n[t-1],n[t],s,r,o))return!1;return!0}function Pi(t,e,i,n,o){var s=Tt([1/0,1/0,-1/0,-1/0],t,e,i,n);return zt(o,s)&&(o[0]<=s[0]&&s[2]<=o[2]&&o[1]<=s[1]&&s[3]<=o[3]||s[0]>=o[0]&&s[2]<=o[2]||s[1]>=o[1]&&s[3]<=o[3]||function(t,e,i,n){var s,r;for(e+=n;e<i;e+=n)if(s=t.slice(e-n,e),r=t.slice(e,e+n),s=function(i,n,s){let r=!1;var o=xt(i,n),a=xt(i,s);if(1===o||1===a)r=!0;else{var l=i[0],h=i[1],d=i[2],i=i[3],u=n[0],n=n[1],c=s[0],s=s[1],n=(s-n)/(c-u);let t,e;2&a&&!(2&o)&&(t=c-(s-i)/n,r=t>=l&&t<=d),r||!(4&a)||4&o||(e=s-(c-d)*n,r=e>=h&&e<=i),r||!(8&a)||8&o||(t=c-(s-h)/n,r=t>=l&&t<=d),r||!(16&a)||16&o||(e=s-(c-l)*n,r=e>=h&&e<=i)}return r}(o,s,r))return s}(t,e,i,n))}function Si(t,e,i,n,s){return!!(Pi(t,e,i,n,s)||P(t,e,i,n,s[0],s[1])||P(t,e,i,n,s[0],s[3])||P(t,e,i,n,s[2],s[1])||P(t,e,i,n,s[2],s[3]))}function Ii(t,e,i,n){let s=0,r=t[i-n],o=t[i-n+1];for(;e<i;e+=n){const i=t[e],n=t[e+1];s+=(i-r)*(n+o),r=i,o=n}return 0===s?void 0:0<s}function Mi(i,n,s,r,o){o=void 0!==o&&o;for(let t=0,e=s.length;t<e;++t){var a=s[t],l=Ii(i,n,a,r);if(0===t?o&&l||!o&&!l:o&&!l||!o&&l){h=void 0;d=void 0;u=void 0;c=void 0;g=void 0;var h=i;var d=n;var u=a;var c=r;for(;d<u-c;){for(let t=0;t<c;++t){var g=h[d+t];h[d+t]=h[u-c+t],h[u-c+t]=g}d+=c,u-=c}}n=a}return n}class Li extends y{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==e&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){if(this.flatCoordinates){var e=this.flatCoordinates,i=t.getFlatCoordinates(),n=Array.isArray(i)?i:[i],s=n.length;for(let t=0;t<s;t++)e[e.length]=n[t]}else this.flatCoordinates=t.getFlatCoordinates().slice();this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){var t=new Li(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<vt(this.getExtent(),t,e))return n;this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(i,n,s,r,o){for(let t=0,e=s.length;t<e;++t){var a=s[t];o=fi(i,n,a,r,o),n=a}return o}(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision());var s=this.flatCoordinates,r=0,o=this.ends_,a=this.stride,l=this.maxDelta_,h=t,d=e,u=i,c=n,g=void 0;g=[NaN,NaN];for(let t=0,e=o.length;t<e;++t){var _=o[t];c=yi(s,r,_,a,l,!0,h,d,u,c,g),r=_}return c}containsXY(t,e){return bi(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){{var n=this.getOrientedFlatCoordinates(),s=0,r=this.ends_,o=this.stride;let i=0;for(let t=0,e=r.length;t<e;++t){var a=r[t];i+=wi(n,s,a,o),s=a}return i}}getCoordinates(t){let e;void 0!==t?Mi(e=this.getOrientedFlatCoordinates().slice(),0,this.ends_,this.stride,t):e=this.flatCoordinates;{var n=e,s=0,r=this.ends_,o=this.stride,a=void 0;a=[];let i=0;for(let t=0,e=r.length;t<e;++t){var l=r[t];a[i++]=Ei(n,s,l,o,a[i]),s=l}return a.length=i,a}}getEnds(){return this.ends_}getFlatInteriorPoint(){var t;return this.flatInteriorPointRevision_!=this.getRevision()&&(t=It(this.getExtent()),this.flatInteriorPoint_=function(i,n,s,r){let o,t,a,l,h,d,u;var c=r[1],g=[];for(let t=0,e=n.length;t<e;++t){const r=n[t];for(l=i[r-s],d=i[r-s+1],o=0;o<r;o+=s)h=i[o],u=i[o+1],(c<=d&&u<=c||d<=c&&c<=u)&&(a=(c-d)/(u-d)*(h-l)+l,g.push(a)),l=h,d=u}let e=NaN,_=-1/0;for(g.sort(j),l=g[0],o=1,t=g.length;o<t;++o){h=g[o];const j=Math.abs(h-l);j>_&&bi(i,0,n,s,a=(l+h)/2,c)&&(e=a,_=j),l=h}return[e=isNaN(e)?r[0]:e,c,_]}(this.getOrientedFlatCoordinates(),this.ends_,this.stride,t),this.flatInteriorPointRevision_=this.getRevision()),this.flatInteriorPoint_}getInteriorPoint(){return new Ri(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Ti(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){var i=this.layout,n=this.flatCoordinates,s=this.ends_,r=[];let o=0;for(let t=0,e=s.length;t<e;++t){var a=s[t],l=new Ti(n.slice(o,a),i);r.push(l),o=a}return r}getOrientedFlatCoordinates(){var t;return this.orientedRevision_!=this.getRevision()&&(!function(i,n,s,r){for(let t=0,e=s.length;t<e;++t){var o=s[t],a=Ii(i,n,o,r);if(0===t){if(!a)return}else if(a)return;n=o}return 1}(t=this.flatCoordinates,0,this.ends_,this.stride)?(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Mi(this.orientedFlatCoordinates_,0,this.ends_,this.stride)):this.orientedFlatCoordinates_=t,this.orientedRevision_=this.getRevision()),this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){var e=[],i=[];return e.length=function(i,n,s,r,o,a,l,h){for(let t=0,e=s.length;t<e;++t){var d=s[t];l=function(s,r,o,a,l,h,d){if(r!=o){let t,e,i=Ci(s[r],l),n=Ci(s[r+1],l);r+=a,h[d++]=i,h[d++]=n;do{if(t=Ci(s[r],l),e=Ci(s[r+1],l),(r+=a)==o)return h[d++]=t,h[d++]=e,d}while(t==i&&e==n);for(;r<o;){const o=Ci(s[r],l),p=Ci(s[r+1],l);var u,c,g,_;r+=a,o==t&&p==e||(u=t-i,c=e-n,g=o-i,_=p-n,e=(t=(u*_==c*g&&(u<0&&g<u||u==g||0<u&&u<g)&&(c<0&&_<c||c==_||0<c&&c<_)||(h[d++]=t,h[d++]=e,i=t,n=e),o),p))}h[d++]=t,h[d++]=e}return d}(i,n,d,r,o,a,l),h.push(l),n=d}return l}(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new Li(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){var i=this.getOrientedFlatCoordinates(),n=this.ends_,s=this.stride,r=t;if(!Si(i,0,n[0],s,r))return!1;if(1!==n.length)for(let t=1,e=n.length;t<e;++t)if(function(e,i,n,s,t){return!Rt(t,function(t){return!P(e,i,n,s,t[0],t[1])})}(i,n[t-1],n[t],s,r)&&!Pi(i,n[t-1],n[t],s,r))return!1;return!0}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);e=function(i,n,s,r,o){o=o||[];let a=0;for(let t=0,e=s.length;t<e;++t){var l=xi(i,n,s[t],r);n=o[a++]=l}return o.length=a,o}(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===e.length?0:e[e.length-1],this.changed()}}const Fi=Li;function Ai(t){var e=t[0],i=t[1],n=t[2],t=t[3],t=[e,i,e,t,n,t,n,i,e,i];return new Li(t,"XY",[t.length])}function zi(t,e){setTimeout(function(){t(e)},0)}function Oi(t,e,i,n,s){var r=Math.cos(-s),s=Math.sin(-s),o=t[0]*r-t[1]*s,t=t[1]*r+t[0]*s;return[(o+=(e[0]/2-i[0])*n)*r-(t+=(i[1]-e[1]/2)*n)*(s=-s),t*r+o*s]}const S=class extends e{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Qe(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&(Ve=!1),t.center&&(t.center=b(t.center,this.projection_)),t.extent&&(t.extent=ii(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(e){var t=Object.assign({},e);for(const e in v)delete t[e];this.setProperties(t,!0);var i=function(t){let e,i,n,s=void 0!==t.minZoom?t.minZoom:0,r=void 0!==t.maxZoom?t.maxZoom:28;const o=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,l=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,h=void 0!==t.showFullExtent&&t.showFullExtent,d=Qe(t.projection,"EPSG:3857"),u=d.getExtent();let c=t.constrainOnlyCenter,g=t.extent;if(a||g||!d.isGlobal()||(c=!1,g=u),void 0!==t.resolutions){const o=t.resolutions;i=o[s],n=void 0!==o[r]?o[r]:o[o.length-1],e=t.constrainResolution?(x=o,C=l,E=!c&&g,w=h,C=void 0===C||C,function(t,e,i,n){var s,r;if(void 0!==t)return r=x[0],s=x[x.length-1],i=E?ri(r,E,i,w):r,n?C?oi(t,i,s):R(t,s,i):(r=Math.min(i,t),n=Math.floor(T(x,r,e)),x[n]>i&&n<x.length-1?x[n+1]:x[n])}):ai(i,n,l,!c&&g,h)}else{const T=(u?Math.max(X(u),K(u)):360*Ie.degrees/d.getMetersPerUnit())/256/Math.pow(2,0),a=T/Math.pow(2,28);void 0!==(i=t.maxResolution)?s=0:i=T/Math.pow(o,s),void 0===(n=t.minResolution)&&(n=void 0!==t.maxZoom?void 0!==t.maxResolution?i/Math.pow(o,r):T/Math.pow(o,r):a),r=s+Math.floor(Math.log(i/n)/Math.log(o)),n=i/Math.pow(o,r-s),e=t.constrainResolution?(_=o,p=i,m=n,v=l,f=!c&&g,y=h,v=void 0===v||v,m=void 0!==m?m:0,function(t,e,i,n){if(void 0!==t)return i=f?ri(p,f,i,y):p,n?v?oi(t,i,m):R(t,m,i):(n=Math.ceil(Math.log(p/i)/Math.log(_)-1e-9),e=-e*(.5-1e-9)+.5,t=Math.min(i,t),t=Math.floor(Math.log(p/t)/Math.log(_)+e),e=Math.max(n,t),R(p/Math.pow(_,e),m,i))}):ai(i,n,l,!c&&g,h)}var _,p,m,v,f,y,x,C,E,w;return{constraint:e,maxResolution:i,minResolution:n,minZoom:s,zoomFactor:o}}(e),n=(this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=e.resolutions,this.padding_=e.padding,this.minZoom_=i.minZoom,function(t){if(void 0!==t.extent){const e=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return ni(t.extent,t.constrainOnlyCenter,e)}const e=Qe(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){const t=e.getExtent().slice();return t[0]=-1/0,t[2]=1/0,ni(t,!1,!1)}return si}(e)),i=i.constraint,s=function(){if(void 0===e.enableRotation||e.enableRotation){var t=e.constrainRotation;if(void 0===t||!0===t)return i=i||Dt(5),function(t,e){return e?t:void 0!==t?Math.abs(t)<=i?0:t:void 0};else if(!1!==t&&"number"==typeof t){const n=2*Math.PI/t;return function(t,e){return e?t:void 0!==t?Math.floor(t/n+.5)*n:void 0};return}else return hi}return li;var i}();this.constraints_={center:n,resolution:i,rotation:s},this.setRotation(void 0!==e.rotation?e.rotation:0),this.setCenterInternal(void 0!==e.center?e.center:null),void 0!==e.resolution?this.setResolution(e.resolution):void 0!==e.zoom&&this.setZoom(e.zoom)}get padding(){return this.padding_}set padding(t){var e,i,n=this.padding_,s=(this.padding_=t,this.getCenter());s&&(t=t||[0,0,0,0],n=n||[0,0,0,0],e=(i=this.getResolution())/2*(t[3]-n[3]+n[1]-t[1]),i=i/2*(t[0]-n[0]+n[2]-t[2]),this.setCenterInternal([s[0]+e,s[1]-i]))}getUpdatedOptions_(t){var e=this.getProperties();return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);var i=new Array(arguments.length);for(let e=0;e<i.length;++e){let t=arguments[e];t.center&&((t=Object.assign({},t)).center=b(t.center,this.getProjection())),t.anchor&&((t=Object.assign({},t)).anchor=b(t.anchor,this.getProjection())),i[e]=t}this.animateInternal.apply(this,i)}animateInternal(s){let r,o=arguments.length,a=(1<o&&"function"==typeof arguments[o-1]&&(r=arguments[o-1],--o),0);for(;a<o&&!this.isDef();++a){const s=arguments[a];s.center&&this.setCenterInternal(s.center),void 0!==s.zoom?this.setZoom(s.zoom):s.resolution&&this.setResolution(s.resolution),void 0!==s.rotation&&this.setRotation(s.rotation)}if(a===o)r&&zi(r,!0);else{let t=Date.now(),e=this.targetCenter_.slice(),i=this.targetResolution_,n=this.targetRotation_;for(var l,h=[];a<o;++a){const s=arguments[a],o={start:t,complete:!1,anchor:s.anchor,duration:void 0!==s.duration?s.duration:1e3,easing:s.easing||ci,callback:r};if(s.center&&(o.sourceCenter=e,o.targetCenter=s.center.slice(),e=o.targetCenter),void 0!==s.zoom?(o.sourceResolution=i,o.targetResolution=this.getResolutionForZoom(s.zoom),i=o.targetResolution):s.resolution&&(o.sourceResolution=i,o.targetResolution=s.resolution,i=o.targetResolution),void 0!==s.rotation){o.sourceRotation=n;const r=m(s.rotation-n+Math.PI,2*Math.PI)-Math.PI;o.targetRotation=n+r,n=o.targetRotation}(l=o).sourceCenter&&l.targetCenter&&!re(l.sourceCenter,l.targetCenter)||l.sourceResolution!==l.targetResolution||l.sourceRotation!==l.targetRotation?t+=o.duration:o.complete=!0,h.push(o)}this.animations_.push(h),this.setHint(0,1),this.updateAnimations_()}}getAnimating(){return 0<this.hints_[0]}getInteracting(){return 0<this.hints_[1]}cancelAnimations(){let i;this.setHint(0,-this.hints_[0]);for(let t=0,e=this.animations_.length;t<e;++t){var n=this.animations_[t];if(n[0].callback&&zi(n[0].callback,!1),!i)for(let t=0,e=n.length;t<e;++t){var s=n[t];if(!s.complete){i=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=i,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){const h=Date.now();let n=!1;for(let t=this.animations_.length-1;0<=t;--t){var s=this.animations_[t];let i=!0;for(let t=0,e=s.length;t<e;++t){var r=s[t];if(!r.complete){var o=h-r.start;let t=0<r.duration?o/r.duration:1;1<=t?(r.complete=!0,t=1):i=!1;o=r.easing(t);if(r.sourceCenter){const h=r.sourceCenter[0],t=r.sourceCenter[1],d=r.targetCenter[0],u=r.targetCenter[1];this.nextCenter_=r.targetCenter;var a=h+o*(d-h),l=t+o*(u-t);this.targetCenter_=[a,l]}if(r.sourceResolution&&r.targetResolution){const h=1===o?r.targetResolution:r.sourceResolution+o*(r.targetResolution-r.sourceResolution);if(r.anchor){const t=this.getViewportSize_(this.getRotation()),c=this.constraints_.resolution(h,0,t,!0);this.targetCenter_=this.calculateCenterZoom(c,r.anchor)}this.nextResolution_=r.targetResolution,this.targetResolution_=h,this.applyTargetState_(!0)}if(void 0!==r.sourceRotation&&void 0!==r.targetRotation){const h=1===o?m(r.targetRotation+Math.PI,2*Math.PI)-Math.PI:r.sourceRotation+o*(r.targetRotation-r.sourceRotation);if(r.anchor){const t=this.constraints_.rotation(h,!0);this.targetCenter_=this.calculateCenterRotate(t,r.anchor)}this.nextRotation_=r.targetRotation,this.targetRotation_=h}if(this.applyTargetState_(!0),n=!0,!r.complete)break}}if(i){this.animations_[t]=null,this.setHint(0,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const h=s[0].callback;h&&zi(h,!0)}}this.animations_=this.animations_.filter(Boolean),n&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}}calculateCenterRotate(t,e){let i;var n=this.getCenterInternal();return void 0!==n&&(oe(i=[n[0]-e[0],n[1]-e[1]],t-this.getRotation()),n=e,(t=i)[0]+=+n[0],t[1]+=+n[1]),i}calculateCenterZoom(t,e){let i;var n=this.getCenterInternal(),s=this.getResolution();return i=void 0!==n&&void 0!==s?[e[0]-t*(e[0]-n[0])/s,e[1]-t*(e[1]-n[1])/s]:i}getViewportSize_(t){var e,i,n=this.viewportSize_;return t?(e=n[0],i=n[1],[Math.abs(e*Math.cos(t))+Math.abs(i*Math.sin(t)),Math.abs(e*Math.sin(t))+Math.abs(i*Math.cos(t))]):n}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){var t=this.getCenterInternal();return t&&ei(t,this.getProjection())}getCenterInternal(){return this.get(v.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){return t=this.calculateExtentInternal(t),this.getProjection(),t}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();var e=this.getCenterInternal(),i=(c(e,1),this.getResolution()),n=(c(void 0!==i,2),this.getRotation());return c(void 0!==n,3),Mt(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(v.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(ii(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();var i=X(t)/e[0],t=K(t)/e[1];return Math.max(i,t)}getResolutionForValueFunction(e){e=e||2;const i=this.getConstrainedResolution(this.maxResolution_),t=this.minResolution_,n=Math.log(i/t)/Math.log(e);return function(t){return i/Math.pow(e,t*n)}}getRotation(){return this.get(v.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(i/n)/e;return function(t){return Math.log(i/t)/e/s}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);t=this.padding_;return e=t?[e[0]-t[1]-t[3],e[1]-t[0]-t[2]]:e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();var s=this.padding_;if(s){const t=this.getViewportSizeMinusPadding_();n=Oi(n,this.getViewportSize_(),[t[0]/2+s[3],t[1]/2+s[0]],e,i)}return{center:n.slice(0),projection:void 0!==t?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getZoom(){let t;var e=this.getResolution();return t=void 0!==e?this.getZoomForResolution(e):t}getZoomForResolution(t){let e,i,n=this.minZoom_||0;var s;return i=this.resolutions_?(s=T(this.resolutions_,t,1),n=s,e=this.resolutions_[s],s==this.resolutions_.length-1?2:e/this.resolutions_[s+1]):(e=this.maxResolution_,this.zoomFactor_),n+Math.log(e/t)/Math.log(i)}getResolutionForZoom(t){var e,i;return this.resolutions_?this.resolutions_.length<=1?0:(e=R(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1],this.resolutions_[e]/Math.pow(i,R(t-e,0,1))):this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(c(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t))c(!Ot(t),25),i=Ai(ii(t,this.getProjection()));else if("Circle"===t.getType()){const e=ii(t.getExtent(),this.getProjection());(i=Ai(e)).rotate(this.getRotation(),It(e))}else{const e=null;i=t}this.fitInternal(i,e)}rotatedExtentForGeometry(t){const i=this.getRotation(),n=Math.cos(i),s=Math.sin(-i),r=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,h=-1/0,d=-1/0;for(let t=0,e=r.length;t<e;t+=o){const i=r[t]*n-r[t+1]*s,o=r[t]*s+r[t+1]*n;a=Math.min(a,i),l=Math.min(l,o),h=Math.max(h,i),d=Math.max(d,o)}return[a,l,h,d]}fitInternal(t,e){let i=(e=e||{}).size;i=i||this.getViewportSizeMinusPadding_();var n=void 0!==e.padding?e.padding:[0,0,0,0],s=void 0!==e.nearest&&e.nearest,r=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0,t=this.rotatedExtentForGeometry(t),o=this.getResolutionForExtentInternal(t,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]),o=isNaN(o)?r:Math.max(o,r),r=(o=this.getConstrainedResolution(o,s?0:1),this.getRotation()),s=Math.sin(r),r=Math.cos(r),t=It(t),n=(t[0]+=(n[1]-n[3])/2*o,t[1]+=(n[0]-n[2])/2*o,t[0]*r-t[1]*s),r=t[1]*r+t[0]*s,t=this.getConstrainedCenter([n,r],o),s=e.callback||O;void 0!==e.duration?this.animateInternal({resolution:o,center:t,duration:e.duration,easing:e.easing},s):(this.targetResolution_=o,this.targetCenter_=t,this.applyTargetState_(!1,!0),zi(s,!0))}centerOn(t,e,i){this.centerOnInternal(b(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(Oi(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let s;var r=this.padding_;return r&&t&&(n=Oi(t,n,[(n=this.getViewportSizeMinusPadding_(-i))[0]/2+r[3],n[1]/2+r[0]],e,i),s=[t[0]-n[0],t[1]-n[1]]),s}isDef(){return!!this.getCenterInternal()&&void 0!==this.getResolution()}adjustCenter(t){var e=ei(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){var e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&b(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){var i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),n=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(n,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e=e&&b(e,this.getProjection()),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){var i=this.getAnimating()||this.getInteracting(),i=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(i,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&b(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){var e=this.getAnimating()||this.getInteracting()||e,i=this.constraints_.rotation(this.targetRotation_,e),n=this.getViewportSize_(i),s=this.constraints_.resolution(this.targetResolution_,0,n,e),e=this.constraints_.center(this.targetCenter_,s,n,e,this.calculateCenterShift(this.targetCenter_,s,i,n));this.get(v.ROTATION)!==i&&this.set(v.ROTATION,i),this.get(v.RESOLUTION)!==s&&(this.set(v.RESOLUTION,s),this.set("zoom",this.getZoom(),!0)),e&&this.get(v.CENTER)&&re(this.get(v.CENTER),e)||this.set(v.CENTER,e),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=void 0!==t?t:200;var e=e||0,n=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(n),e=this.constraints_.resolution(this.targetResolution_,e,s),s=this.constraints_.center(this.targetCenter_,e,s,!1,this.calculateCenterShift(this.targetCenter_,e,n,s));0!==t||this.cancelAnchor_?(i=i||(0===t?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,this.getResolution()===e&&this.getRotation()===n&&this.getCenterInternal()&&re(this.getCenterInternal(),s)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:n,center:s,resolution:e,duration:t,easing:ui,anchor:i}))):(this.targetResolution_=e,this.targetRotation_=n,this.targetCenter_=s,this.applyTargetState_())}beginInteraction(){this.resolveConstraints(0),this.setHint(1,1)}endInteraction(t,e,i){i=i&&b(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.setHint(1,-1),this.resolveConstraints(t,e,i)}getConstrainedCenter(t,e){var i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){t=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(t,e))}getConstrainedResolution(t,e){e=e||0;var i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}},Di=class extends e{constructor(t){super();var e=t.element;!e||t.target||e.style.pointerEvents||(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){_e(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&_e(this.element);for(let t=0,e=this.listenerKeys.length;t<e;++t)a(this.listenerKeys[t]);this.listenerKeys.length=0,(this.map_=t)&&((this.target_||t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==O&&this.listenerKeys.push(r(t,Ce,this.render,this)),t.render())}render(t){}setTarget(t){this.target_="string"==typeof t?document.getElementById(t):t}},ki=class extends Di{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=void 0===t.collapsed||t.collapsed,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=void 0!==t.collapsible,this.collapsible_=void 0===t.collapsible||t.collapsible,this.collapsible_||(this.collapsed_=!1);var e=void 0!==t.className?t.className:"ol-attribution",i=void 0!==t.tipLabel?t.tipLabel:"Attributions",n=void 0!==t.expandClassName?t.expandClassName:e+"-expand",s=void 0!==t.collapseLabel?t.collapseLabel:"›",r=void 0!==t.collapseClassName?t.collapseClassName:e+"-collapse",r=("string"==typeof s?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=s,this.collapseLabel_.className=r):this.collapseLabel_=s,void 0!==t.label?t.label:"i"),s=("string"==typeof r?(this.label_=document.createElement("span"),this.label_.textContent=r,this.label_.className=n):this.label_=r,this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_),t=(this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(s),this.toggleButton_.addEventListener(V,this.handleClick_.bind(this),!1),e+" ol-unselectable "+ue+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible")),n=this.element;n.className=t,n.appendChild(this.toggleButton_),n.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(i){var n={},s=[];let r=!0;var o=i.layerStatesArray;for(let t=0,e=o.length;t<e;++t){var a=o[t];if(ne(a,i.viewState)){a=a.layer.getSource();if(a){var l=a.getAttributions();if(l){var h=l(i);if(h)if(r=r&&!1!==a.getAttributionsCollapsible(),Array.isArray(h))for(let t=0,e=h.length;t<e;++t)h[t]in n||(s.push(h[t]),n[h[t]]=!0);else h in n||(s.push(h),n[h]=!0)}}}}return this.overrideCollapsible_||this.setCollapsible(r),s}updateElement_(t){if(t){const i=this.collectSourceAttributions_(t),n=0<i.length;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!F(i,this.renderedAttributions_)){for(var e=this.ulElement_;e.lastChild;)e.removeChild(e.lastChild);for(let t=0,e=i.length;t<e;++t){const n=document.createElement("li");n.innerHTML=i[t],this.ulElement_.appendChild(n)}this.renderedAttributions_=i}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?ge(this.collapseLabel_,this.label_):ge(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_)&&this.handleToggle_()}setCollapsed(t){this.userCollapsed_=t,this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}},ji=class extends Di{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});var e=void 0!==t.className?t.className:"ol-rotate",i=void 0!==t.label?t.label:"⇧",n=void 0!==t.compassClassName?t.compassClassName:"ol-compass",i=(this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n)),t.tipLabel||"Reset rotation"),n=document.createElement("button"),i=(n.className=e+"-reset",n.setAttribute("type","button"),n.title=i,n.appendChild(this.label_),n.addEventListener(V,this.handleClick_.bind(this),!1),e+" ol-unselectable "+ue),e=this.element;e.className=i,e.appendChild(n),this.callResetNorth_=t.resetNorth||void 0,this.duration_=void 0!==t.duration?t.duration:250,this.autoHide_=void 0===t.autoHide||t.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(de)}handleClick_(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()}resetNorth_(){var t,e=this.getMap().getView();e&&void 0!==(t=e.getRotation())&&(0<this.duration_&&t%(2*Math.PI)!=0?e.animate({rotation:0,duration:this.duration_,easing:ui}):e.setRotation(0))}render(t){t=t.frameState;if(t){var e=t.viewState.rotation;if(e!=this.rotation_){const t="rotate("+e+"rad)";if(this.autoHide_){const t=this.element.classList.contains(de);t||0!==e?t&&0!==e&&this.element.classList.remove(de):this.element.classList.add(de)}this.label_.style.transform=t}this.rotation_=e}}},Ni=class extends Di{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});var e=void 0!==t.className?t.className:"ol-zoom",i=void 0!==t.delta?t.delta:1,n=void 0!==t.zoomInClassName?t.zoomInClassName:e+"-in",s=void 0!==t.zoomOutClassName?t.zoomOutClassName:e+"-out",r=void 0!==t.zoomInLabel?t.zoomInLabel:"+",o=void 0!==t.zoomOutLabel?t.zoomOutLabel:"–",a=void 0!==t.zoomInTipLabel?t.zoomInTipLabel:"Zoom in",l=void 0!==t.zoomOutTipLabel?t.zoomOutTipLabel:"Zoom out",h=document.createElement("button"),n=(h.className=n,h.setAttribute("type","button"),h.title=a,h.appendChild("string"==typeof r?document.createTextNode(r):r),h.addEventListener(V,this.handleClick_.bind(this,i),!1),document.createElement("button")),a=(n.className=s,n.setAttribute("type","button"),n.title=l,n.appendChild("string"==typeof o?document.createTextNode(o):o),n.addEventListener(V,this.handleClick_.bind(this,-i),!1),e+" ol-unselectable "+ue),r=this.element;r.className=a,r.appendChild(h),r.appendChild(n),this.duration_=void 0!==t.duration?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){var e,i=this.getMap().getView();i&&void 0!==(e=i.getZoom())&&(e=i.getConstrainedZoom(e+t),0<this.duration_?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:e,duration:this.duration_,easing:ui})):i.setZoom(e))}};function Zi(t,e,i,n){var s=t.getZoom();void 0!==s&&(s=t.getConstrainedZoom(s+e),e=t.getResolutionForZoom(s),t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:e,anchor:i,duration:void 0!==n?n:250,easing:ui}))}const Ki=class extends e{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get("active")}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set("active",t)}setMap(t){this.map_=t}},Gi=class extends Ki{constructor(t){super(),this.delta_=(t=t||{}).delta||1,this.duration_=void 0!==t.duration?t.duration:250}handleEvent(t){let e=!1;var i,n,s;return t.type==p.DBLCLICK&&(i=t.originalEvent,n=t.map,t=t.coordinate,s=i.shiftKey?-this.delta_:this.delta_,Zi(n.getView(),s,t,this.duration_),i.preventDefault(),e=!0),!e}};function Xi(e){var i=e.length;let n=0,s=0;for(let t=0;t<i;t++)n+=e[t].clientX,s+=e[t].clientY;return[n/i,s/i]}C=class extends Ki{constructor(t){super(t=t||{}),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;var i;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==p.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==p.POINTERUP){const e=this.handleUpEvent(t);this.handlingDownUpSequence=e&&0<this.targetPointers.length}}else t.type==p.POINTERDOWN?(i=this.handleDownEvent(t),this.handlingDownUpSequence=i,e=this.stopDown(i)):t.type==p.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}};function Ui(){const s=arguments;return function(i){let n=!0;for(let t=0,e=s.length;t<e&&(n=n&&s[t](i));++t);return n}}function Vi(t){return(t=t.originalEvent).altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey}function Wi(t){return!t.map.getTargetElement().hasAttribute("tabindex")||(e=(t=t).map.getTargetElement(),t=t.map.getOwnerDocument().activeElement,e.contains(t));var e}function Yi(t){return 0==(t=t.originalEvent).button&&!(at&&lt&&t.ctrlKey)}function qi(t){return!(t=t.originalEvent).altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey}function Bi(t){return!(t=t.originalEvent).altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey}function Hi(t){var e=(t=t.originalEvent).target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e&&!t.target.isContentEditable}function Qi(t){return c(void 0!==(t=t.originalEvent),56),"mouse"==t.pointerType}function $i(t){return c(void 0!==(t=t.originalEvent),56),t.isPrimary&&0===t.button}const Ji=A,tn=class extends C{constructor(t){super({stopDown:z}),this.kinetic_=(t=t||{}).kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;var e=t.condition||Ui(qi,$i);this.condition_=t.onFocusOnly?Ui(Wi,e):e,this.noKinetic_=!1}handleDragEvent(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());const e=this.targetPointers,i=Xi(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(i[0],i[1]),this.lastCentroid){const e=[this.lastCentroid[0]-i[0],i[1]-this.lastCentroid[1]],r=t.map.getView();n=e,s=r.getResolution(),n[0]*=s,n[1]*=s,oe(e,r.getRotation()),r.adjustCenterInternal(e)}}else this.kinetic_&&this.kinetic_.begin();var n,s;this.lastCentroid=i,this.lastPointersCount_=e.length,t.originalEvent.preventDefault()}handleUpEvent(t){var e=t.map,i=e.getView();if(0!==this.targetPointers.length)return this.kinetic_&&this.kinetic_.begin(),!(this.lastCentroid=null);if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const t=this.kinetic_.getDistance(),n=this.kinetic_.getAngle(),s=i.getCenterInternal(),r=e.getPixelFromCoordinateInternal(s),o=e.getCoordinateFromPixelInternal([r[0]-t*Math.cos(n),r[1]-t*Math.sin(n)]);i.animateInternal({center:i.getConstrainedCenter(o),duration:500,easing:ui})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}handleDownEvent(t){return!!(0<this.targetPointers.length&&this.condition_(t))&&(t=t.map.getView(),this.lastCentroid=null,t.getAnimating()&&t.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=1<this.targetPointers.length,!0)}},en=class extends C{constructor(t){t=t||{},super({stopDown:z}),this.condition_=t.condition||Vi,this.lastAngle_=void 0,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){if(Qi(t)){var e=t.map,i=e.getView();if(i.getConstraints().rotation!==li){e=e.getSize(),t=t.pixel,e=Math.atan2(e[1]/2-t[1],t[0]-e[0]/2);if(void 0!==this.lastAngle_){const t=e-this.lastAngle_;i.adjustRotationInternal(-t)}this.lastAngle_=e}}}handleUpEvent(t){return!Qi(t)||(t.map.getView().endInteraction(this.duration_),!1)}handleDownEvent(t){return!(!Qi(t)||!Yi(t)||!this.condition_(t)||(t.map.getView().beginInteraction(),this.lastAngle_=void 0))}},nn=class extends L{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){var t=this.startPixel_,e=this.endPixel_,i=this.element_.style;i.left=Math.min(t[0],e[0])+"px",i.top=Math.min(t[1],e[1])+"px",i.width=Math.abs(e[0]-t[0])+"px",i.height=Math.abs(e[1]-t[1])+"px"}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const t=this.element_.style;t.left="inherit",t.top="inherit",t.width="inherit",t.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){var t=this.startPixel_,e=this.endPixel_,e=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);e[4]=e[0].slice(),this.geometry_?this.geometry_.setCoordinates([e]):this.geometry_=new Fi([e])}getGeometry(){return this.geometry_}};class sn extends t{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}const rn=class extends C{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new nn(t.className||"ol-dragbox"),this.minArea_=void 0!==t.minArea?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition||Yi,this.boxEndCondition_=t.boxEndCondition||this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){var n=i[0]-e[0],i=i[1]-e[1];return n*n+i*i>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new sn("boxdrag",t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);var e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new sn(e?"boxend":"boxcancel",t.coordinate,t)),!1}handleDownEvent(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new sn("boxstart",t.coordinate,t)),!0)}onBoxEnd(t){}},on=class extends rn{constructor(t){super({condition:(t=t||{}).condition?t.condition:Bi,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=void 0!==t.duration?t.duration:200,this.out_=void 0!==t.out&&t.out}onBoxEnd(t){var e=this.getMap().getView();let i=this.getGeometry();if(this.out_){const t=e.rotatedExtentForGeometry(i),n=e.getResolutionForExtentInternal(t),s=e.getResolution()/n;(i=i.clone()).scale(s*s)}e.fitInternal(i,{duration:this.duration_,easing:ui})}},an=class extends Ki{constructor(t){super(),t=t||{},this.defaultCondition_=function(t){return qi(t)&&Hi(t)},this.condition_=void 0!==t.condition?t.condition:this.defaultCondition_,this.duration_=void 0!==t.duration?t.duration:100,this.pixelDelta_=void 0!==t.pixelDelta?t.pixelDelta:128}handleEvent(i){let n=!1;if(i.type==W){var s=i.originalEvent,r=s.keyCode;if(this.condition_(i)&&(40==r||37==r||39==r||38==r)){var i=i.map.getView(),o=i.getResolution()*this.pixelDelta_;let t=0,e=0;40==r?e=-o:37==r?t=-o:39==r?t=o:e=o;r=[t,e];oe(r,i.getRotation()),o=i,i=r,r=this.duration_,(a=o.getCenterInternal())&&(a=[a[0]+i[0],a[1]+i[1]],o.animateInternal({duration:void 0!==r?r:250,easing:gi,center:o.getConstrainedCenter(a)})),s.preventDefault(),n=!0}}var a;return!n}},ln=class extends Ki{constructor(t){super(),this.condition_=(t=t||{}).condition||Hi,this.delta_=t.delta||1,this.duration_=void 0!==t.duration?t.duration:100}handleEvent(t){let e=!1;var i,n;return t.type!=W&&t.type!=Y||(n=(i=t.originalEvent).charCode,!this.condition_(t))||n!="+".charCodeAt(0)&&n!="-".charCodeAt(0)||(t=t.map,n=n=="+".charCodeAt(0)?this.delta_:-this.delta_,Zi(t.getView(),n,void 0,this.duration_),i.preventDefault(),e=!0),!e}},hn=class extends Ki{constructor(t){super(t=t||{}),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=void 0!==t.maxDelta?t.maxDelta:1,this.duration_=void 0!==t.duration?t.duration:250,this.timeout_=void 0!==t.timeout?t.timeout:80,this.useAnchor_=void 0===t.useAnchor||t.useAnchor,this.constrainResolution_=void 0!==t.constrainResolution&&t.constrainResolution;var e=t.condition||Ji;this.condition_=t.onFocusOnly?Ui(Wi,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;var t=this.getMap();t&&t.getView().endInteraction(void 0,this.lastDelta_?0<this.lastDelta_?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t))return!0;if(t.type!==B)return!0;var e,i=t.map,n=t.originalEvent;let s;return n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==B&&(s=n.deltaY,ot&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(s/=ht),n.deltaMode===WheelEvent.DOM_DELTA_LINE)&&(s*=40),0!==s&&(this.lastDelta_=s,t=Date.now(),void 0===this.startTime_&&(this.startTime_=t),(!this.mode_||t-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(s)<4?"trackpad":"wheel"),n=i.getView(),"trackpad"!==this.mode_||n.getConstrainResolution()||this.constrainResolution_?(this.totalDelta_+=s,e=Math.max(this.timeout_-(t-this.startTime_),0),clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),e)):(this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(n.getAnimating()&&n.cancelAnimations(),n.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),n.adjustZoom(-s/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=t)),!1}handleWheelZoom_(t){t=t.getView();t.getAnimating()&&t.cancelAnimations();let e=-R(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(t.getConstrainResolution()||this.constrainResolution_)&&(e=e?0<e?1:-1:0),Zi(t,e,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){(this.useAnchor_=t)||(this.lastAnchor_=null)}},dn=class extends C{constructor(t){var e=t=t||{};e.stopDown||(e.stopDown=z),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==t.threshold?t.threshold:.3,this.duration_=void 0!==t.duration?t.duration:250}handleDragEvent(t){let e=0;var i=this.targetPointers[0],n=this.targetPointers[1],n=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(void 0!==this.lastAngle_){const t=n-this.lastAngle_;this.rotationDelta_+=t,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=t}this.lastAngle_=n;var s,i=t.map,n=i.getView();n.getConstraints().rotation!==li&&(t=i.getViewport().getBoundingClientRect(),(s=Xi(this.targetPointers))[0]-=t.left,s[1]-=t.top,this.anchor_=i.getCoordinateFromPixelInternal(s),this.rotating_)&&(i.render(),n.adjustRotationInternal(e,this.anchor_))}handleUpEvent(t){return!(this.targetPointers.length<2&&(t.map.getView().endInteraction(this.duration_),1))}handleDownEvent(t){return 2<=this.targetPointers.length&&(t=t.map,this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||t.getView().beginInteraction(),!0)}},un=class extends C{constructor(t){var e=t=t||{};e.stopDown||(e.stopDown=z),super(e),this.anchor_=null,this.duration_=void 0!==t.duration?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;var i=this.targetPointers[0],n=this.targetPointers[1],s=i.clientX-n.clientX,i=i.clientY-n.clientY,n=Math.sqrt(s*s+i*i),s=(void 0!==this.lastDistance_&&(e=this.lastDistance_/n),this.lastDistance_=n,t.map),i=s.getView(),n=(1!=e&&(this.lastScaleDelta_=e),s.getViewport().getBoundingClientRect()),t=Xi(this.targetPointers);t[0]-=n.left,t[1]-=n.top,this.anchor_=s.getCoordinateFromPixelInternal(t),s.render(),i.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){var e;return!(this.targetPointers.length<2&&(t=t.map.getView(),e=1<this.lastScaleDelta_?1:-1,t.endInteraction(this.duration_,e),1))}handleDownEvent(t){return 2<=this.targetPointers.length&&(t=t.map,this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||t.getView().beginInteraction(),!0)}};function cn(t){return 0<t[0]&&0<t[1]}function I(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:(e[0]=t,e[1]=t),e)}function gn(t){t instanceof se?t.setMapInternal(null):t instanceof fe&&t.getLayers().forEach(gn)}const _n=class extends e{constructor(t){super(),this.on,this.once,this.un;var e,i,n,s=function(t){let e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var i={},n=t.layers&&"function"==typeof t.layers.getLayers?t.layers:new fe({layers:t.layers});let s,r,o;return i.layergroup=n,i.target=t.target,i.view=t.view instanceof S?t.view:new S,void 0!==t.controls&&(s=Array.isArray(t.controls)?new u(t.controls.slice()):(c("function"==typeof t.controls.getArray,47),t.controls)),void 0!==t.interactions&&(r=Array.isArray(t.interactions)?new u(t.interactions.slice()):(c("function"==typeof t.interactions.getArray,48),t.interactions)),o=void 0!==t.overlays?Array.isArray(t.overlays)?new u(t.overlays.slice()):(c("function"==typeof t.overlays.getArray,49),t.overlays):new u,{controls:s,interactions:r,keyboardEventTarget:e,overlays:o,values:i}}(t=t||{});this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:ht,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=[1,0,0,1,0,0],this.pixelToCoordinateTransform_=[1,0,0,1,0,0],this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=s.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.controls=s.controls||(i={},n=new u,void 0!==i.zoom&&!i.zoom||n.push(new Ni(i.zoomOptions)),void 0!==i.rotate&&!i.rotate||n.push(new ji(i.rotateOptions)),void 0!==i.attribution&&!i.attribution||n.push(new ki(i.attributionOptions)),n),this.interactions=s.interactions||(i={onFocusOnly:!0},n=new u,e=new class{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[2+e]<t)return!1;let i=e-3;for(;0<i&&this.points_[i+2]>t;)i-=3;var n,s=this.points_[2+e]-this.points_[i+2];return!(s<1e3/60)&&(n=this.points_[e]-this.points_[i],e=this.points_[1+e]-this.points_[i+1],this.angle_=Math.atan2(e,n),this.initialVelocity_=Math.sqrt(n*n+e*e)/s,this.initialVelocity_>this.minVelocity_)}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}(-.005,.05,100),void 0!==i.altShiftDragRotate&&!i.altShiftDragRotate||n.push(new en),void 0!==i.doubleClickZoom&&!i.doubleClickZoom||n.push(new Gi({delta:i.zoomDelta,duration:i.zoomDuration})),void 0!==i.dragPan&&!i.dragPan||n.push(new tn({onFocusOnly:i.onFocusOnly,kinetic:e})),void 0!==i.pinchRotate&&!i.pinchRotate||n.push(new dn),void 0!==i.pinchZoom&&!i.pinchZoom||n.push(new un({duration:i.zoomDuration})),void 0!==i.keyboard&&!i.keyboard||(n.push(new an),n.push(new ln({delta:i.zoomDelta,duration:i.zoomDuration}))),void 0!==i.mouseWheelZoom&&!i.mouseWheelZoom||n.push(new hn({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),void 0!==i.shiftDragZoom&&!i.shiftDragZoom||n.push(new on({duration:i.zoomDuration})),n),this.overlays_=s.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new Se(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Te,this.handleLayerGroupChanged_),this.addChangeListener(Pe,this.handleViewChanged_),this.addChangeListener(Re,this.handleSizeChanged_),this.addChangeListener(be,this.handleTargetChanged_),this.setProperties(s.values);const r=this;!t.view||t.view instanceof S||t.view.then(function(t){r.setView(new S(t))}),this.controls.addEventListener(h,function(t){t.element.setMap(this)}.bind(this)),this.controls.addEventListener(d,function(t){t.element.setMap(null)}.bind(this)),this.interactions.addEventListener(h,function(t){t.element.setMap(this)}.bind(this)),this.interactions.addEventListener(d,function(t){t.element.setMap(null)}.bind(this)),this.overlays_.addEventListener(h,function(t){this.addOverlayInternal_(t.element)}.bind(this)),this.overlays_.addEventListener(d,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)}.bind(this)),this.controls.forEach(function(t){t.setMap(this)}.bind(this)),this.interactions.forEach(function(t){t.setMap(this)}.bind(this)),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){!function i(t,n){if(t instanceof se)t.setMapInternal(n);else if(t instanceof fe){var s=t.getLayers().getArray();for(let t=0,e=s.length;t<e;++t)i(s[t],n)}}(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){var n,s;if(this.frameState_&&this.renderer_)return t=this.getCoordinateFromPixelInternal(t),n=void 0!==(i=void 0!==i?i:{}).hitTolerance?i.hitTolerance:0,s=void 0!==i.layerFilter?i.layerFilter:A,i=!1!==i.checkWrapped,this.renderer_.forEachFeatureAtCoordinate(t,this.frameState_,n,i,e,null,s,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(t){i.push(t)},e),i}getAllLayers(){const i=[];return function e(t){t.forEach(function(t){t instanceof fe?e(t.getLayers()):i.push(t)})}(this.getLayers()),i}hasFeatureAtPixel(t,e){var i,n;return!(!this.frameState_||!this.renderer_)&&(t=this.getCoordinateFromPixelInternal(t),i=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:A,n=void 0!==e.hitTolerance?e.hitTolerance:0,e=!1!==e.checkWrapped,this.renderer_.hasFeatureAtCoordinate(t,this.frameState_,n,e,i,null))}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){var e=this.viewport_.getBoundingClientRect(),t="changedTouches"in t?t.changedTouches[0]:t;return[t.clientX-e.left,t.clientY-e.top]}getTarget(){return this.get(be)}getTargetElement(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null}getCoordinateFromPixel(t){return ei(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){var e=this.frameState_;return e?Z(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){t=this.overlayIdIndex_[t.toString()];return void 0!==t?t:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Te)}setLayers(t){var e=this.getLayerGroup();t instanceof u?e.setLayers(t):((e=e.getLayers()).clear(),e.extend(t))}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){var i=this.getLayerGroup().getLayerStatesArray();for(let t=0,e=i.length;t<e;++t){var n=i[t];if(n.visible){var s=n.layer.getRenderer();if(s&&!s.ready)return!0;s=n.layer.getSource();if(s&&s.loading)return!0}}return!1}getPixelFromCoordinate(t){t=b(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)}getPixelFromCoordinateInternal(t){var e=this.frameState_;return e?Z(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Re)}getView(){return this.get(Pe)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){var t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return s=this.frameState_,t=t,e=e,i=i,n=n,s&&e in s.wantedTiles&&s.wantedTiles[e][t.getKey()]?(e=s.viewState.center,t=i[0]-e[0],s=i[1]-e[1],65536*Math.log(n)+Math.sqrt(t*t+s*s)/n):1/0;var s}handleBrowserEvent(t,e){e=e||t.type;e=new n(e,this,t);this.handleMapBrowserEvent(e)}handleMapBrowserEvent(e){if(this.frameState_){const n=e.originalEvent,t=n.type;if(t===ye||t===B||t===W){const e=this.getOwnerDocument(),t=this.viewport_.getRootNode?this.viewport_.getRootNode():e,s=n.target;if(this.overlayContainerStopEvent_.contains(s)||!(t===e?e.documentElement:t).contains(s))return}if(e.frameState=this.frameState_,!1!==this.dispatchEvent(e)){const n=this.getInteractions().getArray().slice();for(let t=n.length-1;0<=t;t--){var i=n[t];if(i.getMap()===this&&i.getActive()&&this.getTargetElement()&&(!i.handleEvent(e)||e.propagationStopped))break}}}}handlePostRender(){const i=this.frameState_,n=this.tileQueue_;if(!n.isEmpty()){let t=this.maxTilesLoading_,e=t;if(i){const n=i.viewHints;if(n[0]||n[1]){const n=8<Date.now()-i.time;t=n?0:8,e=n?0:2}}n.getTilesLoading()<t&&(n.reprioritize(),n.loadMoreTiles(t,e))}i&&this.renderer_&&!i.animate&&(!0===this.renderComplete_?(this.hasListener(ie)&&this.renderer_.dispatchRenderEvent(ie,i),!1===this.loaded_&&(this.loaded_=!0,this.dispatchEvent(new _(we,this,i)))):!0===this.loaded_&&(this.loaded_=!1,this.dispatchEvent(new _(Ee,this,i))));var s=this.postRenderFunctions_;for(let t=0,e=s.length;t<e;++t)s[t](this,i);s.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let t=0,e=this.targetChangeHandlerKeys_.length;t<e;++t)a(this.targetChangeHandlerKeys_[t]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(U,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(B,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,_e(this.viewport_)}const t=this.getTargetElement();if(t){t.appendChild(this.viewport_),this.renderer_||(this.renderer_=new me(this)),this.mapBrowserEventHandler_=new xe(this,this.moveTolerance_);for(const t in p)this.mapBrowserEventHandler_.addEventListener(p[t],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(U,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(B,this.boundHandleBrowserEvent_,!!ct&&{passive:!1});var e=this.getOwnerDocument().defaultView,i=this.keyboardEventTarget_||t;this.targetChangeHandlerKeys_=[r(i,W,this.handleBrowserEvent,this),r(i,Y,this.handleBrowserEvent,this),r(e,"resize",this.updateSize,this)]}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(a(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(a(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=r(t,M,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=r(t,o,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(a),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.handleLayerAdd_(new s("addlayer",t)),this.layerGroupPropertyListenerKeys_=[r(t,M,this.render,this),r(t,o,this.render,this),r(t,"addlayer",this.handleLayerAdd_,this),r(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){var i=this.getLayerGroup().getLayerStatesArray();for(let t=0,e=i.length;t<e;++t){var n=i[t].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){gn(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let s=null;if(void 0!==e&&cn(e)&&i&&i.isDef()){const n=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),r=i.getState();if(s={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:Mt(r.center,r.resolution,r.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:r,viewHints:n,wantedTiles:{},mapId:N(this),renderTargets:{}},r.nextCenter&&r.nextResolution){const t=isNaN(r.nextRotation)?r.rotation:r.nextRotation;s.nextExtent=Mt(r.nextCenter,r.nextResolution,t,e)}}var r;this.frameState_=s,this.renderer_.renderFrame(s),!s||(s.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,s.postRenderFunctions),!n||this.previousExtent_&&(Ot(this.previousExtent_)||Et(s.extent,this.previousExtent_))||(this.dispatchEvent(new _("movestart",this,n)),this.previousExtent_=Ct(this.previousExtent_)),!this.previousExtent_)||s.viewHints[0]||s.viewHints[1]||Et(s.extent,this.previousExtent_)||(this.dispatchEvent(new _("moveend",this,s)),r=s.extent,(t=this.previousExtent_)?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3]):r.slice()),this.dispatchEvent(new _(Ce,this,s)),this.renderComplete_=this.hasListener(Ee)||this.hasListener(we)||this.hasListener(ie)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){var e=this.getLayerGroup();e&&this.handleLayerRemove_(new s("removelayer",e)),this.set(Te,t)}setSize(t){this.set(Re,t)}setTarget(t){this.set(be,t)}setView(t){if(!t||t instanceof S)this.set(Pe,t);else{this.set(Pe,new S);const e=this;t.then(function(t){e.setView(new S(t))})}}updateSize(){var t,e,i=this.getTargetElement();let n;i&&(e=getComputedStyle(i),t=i.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),e=i.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth),isNaN(t)||isNaN(e)||!cn(n=[t,e])&&(i.offsetWidth||i.offsetHeight||i.getClientRects().length)&&console.warn("No map visible because the map container's width or height are 0.")),this.setSize(n),this.updateViewportSize_()}updateViewportSize_(){var e=this.getView();if(e){let t;var i=getComputedStyle(this.viewport_);i.width&&i.height&&(t=[parseInt(i.width,10),parseInt(i.height,10)]),e.setViewportSize(t)}}},pn=class extends k{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(o)}release(){3===this.state&&this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(this.interimTile){let t=this.interimTile;do{if(2==t.getState())return this.transition_=0,t}while(t=t.interimTile)}return this}refreshInterimChain(){if(this.interimTile){let t=this.interimTile,e=this;do{if(2==t.getState()){t.interimTile=null;break}}while(1!=t.getState()&&0==t.getState()?e.interimTile=t.interimTile:e=t,t=e.interimTile)}}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(3!==this.state&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){l()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(i){if(-1===i)return 1}else i=e,this.transitionStarts_[t]=i;t=e-i+1e3/60;return t>=this.transition_?1:di(t/this.transition_)}inTransition(t){return!!this.transition_&&-1!==this.transitionStarts_[t]}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}},mn=class extends pn{constructor(t,e,i,n,s,r){super(t,e,r),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=s}getImage(){return this.image_}setImage(t){this.image_=t,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){var t;this.state=3,this.unlistenImage_(),this.image_=((t=ce(1,1)).fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas),this.changed()}handleImageLoad_(){var t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_)&&(this.image_.crossOrigin=this.crossOrigin_),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=function(t,e,i){let n=!0,s=!1,r=!1;const o=[H(t,"load",function(){r=!0,s||e()})];return t.src&&ut?(s=!0,t.decode().then(function(){n&&e()}).catch(function(t){n&&(r?e:i)()})):o.push(H(t,"error",i)),function(){n=!1,o.forEach(a)}}(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}};let vn;const fn=[];function yn(t,e,i,n,s){t.beginPath(),t.moveTo(0,0),t.lineTo(e,i),t.lineTo(n,s),t.closePath(),t.save(),t.clip(),t.fillRect(0,0,Math.max(e,n)+1,Math.max(i,s)),t.restore()}function xn(t,e){return 2<Math.abs(t[4*e]-210)||2<Math.abs(t[4*e+3]-191.25)}function Cn(t,e,i,n){s=i;var s=ti(e,t)(s,void 0,s.length);let r=Be(e,n,i);n=e.getMetersPerUnit(),void 0!==n&&(r*=n),i=t.getMetersPerUnit(),void 0!==i&&(r/=i),e=t.getExtent();if(!e||ft(e,s)){const e=Be(t,r,s)/r;isFinite(e)&&0<e&&(r/=e)}return r}const En=class extends pn{constructor(i,e,t,n,s,r,o,a,l,h,d,u){super(s,0,{interpolate:!!u}),this.renderEdges_=void 0!==d&&d,this.pixelRatio_=o,this.gutter_=a,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=r||s,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;u=n.getTileCoordExtent(this.wrappedTileCoord_),d=this.targetTileGrid_.getExtent();let c=this.sourceTileGrid_.getExtent();a=d?Ft(u,d):u;if(0===bt(a))this.state=4;else{r=i.getExtent(),s=(r&&(c=c?Ft(c,r):r),n.getResolution(this.wrappedTileCoord_[0])),d=function(e,i,t,n){var s=It(t);let r=Cn(e,i,s,n);return(!isFinite(r)||r<=0)&&Rt(t,function(t){return r=Cn(e,i,t,n),isFinite(r)&&0<r}),r}(i,t,a,s);if(!isFinite(d)||d<=0)this.state=4;else if(this.triangulation_=new class{constructor(t,e,i,n,s,r){this.sourceProj_=t,this.targetProj_=e;let o={};const a=ti(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=n,this.errorThresholdSquared_=s*s,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&X(n)==X(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?X(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?X(this.targetProj_.getExtent()):null;var t=G(i),e=At(i),s=St(i),n=Pt(i),l=this.transformInv_(t),h=this.transformInv_(e),d=this.transformInv_(s),u=this.transformInv_(n),i=10+(r?Math.max(0,Math.ceil(Math.log2(bt(i)/(r*r*256*256)))):0);if(this.addQuad_(t,e,s,n,l,h,d,u,i),this.wrapsXInSource_){let n=1/0;this.triangles_.forEach(function(t,e,i){n=Math.min(n,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){var e,i;Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-n>this.sourceWorldWidth_/2&&((e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]])[0][0]-n>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-n>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-n>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_),i=Math.min(e[0][0],e[1][0],e[2][0]),Math.max(e[0][0],e[1][0],e[2][0])-i<this.sourceWorldWidth_/2)&&(t.source=e)}.bind(this))}o={}}addTriangle_(t,e,i,n,s,r){this.triangles_.push({source:[n,s,r],target:[t,e,i]})}addQuad_(e,i,n,s,r,o,a,l,h){const d=mt([r,o,a,l]),u=this.sourceWorldWidth_?X(d)/this.sourceWorldWidth_:null,c=this.sourceWorldWidth_,g=this.sourceProj_.canWrapX()&&.5<u&&u<1;let _=!1;if(!(!(_=0<h&&(this.targetProj_.isGlobal()&&this.targetWorldWidth_&&(_=.25<X(mt([e,i,n,s]))/this.targetWorldWidth_||_),!g)&&this.sourceProj_.isGlobal()&&u?.25<u||_:_)&&this.maxSourceExtent_&&isFinite(d[0])&&isFinite(d[1])&&isFinite(d[2])&&isFinite(d[3]))||zt(d,this.maxSourceExtent_)){let t=0;if(!(_||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(l[0])&&isFinite(l[1])))if(0<h)_=!0;else if(1!=(t=(isFinite(r[0])&&isFinite(r[1])?0:8)+(isFinite(o[0])&&isFinite(o[1])?0:4)+(isFinite(a[0])&&isFinite(a[1])?0:2)+(isFinite(l[0])&&isFinite(l[1])?0:1))&&2!=t&&4!=t&&8!=t)return;if(0<h){if(!_){const i=[(e[0]+n[0])/2,(e[1]+n[1])/2],s=this.transformInv_(i);var p=g?(m(r[0],c)+m(a[0],c))/2-m(s[0],c):(r[0]+a[0])/2-s[0];const l=(r[1]+a[1])/2-s[1];_=p*p+l*l>this.errorThresholdSquared_}if(_){if(Math.abs(e[0]-n[0])<=Math.abs(e[1]-n[1])){const d=[(i[0]+n[0])/2,(i[1]+n[1])/2],u=this.transformInv_(d),c=[(s[0]+e[0])/2,(s[1]+e[1])/2],g=this.transformInv_(c);this.addQuad_(e,i,d,c,r,o,u,g,h-1),this.addQuad_(c,d,n,s,g,u,a,l,h-1)}else{const d=[(e[0]+i[0])/2,(e[1]+i[1])/2],u=this.transformInv_(d),c=[(n[0]+s[0])/2,(n[1]+s[1])/2],g=this.transformInv_(c);this.addQuad_(e,d,c,s,r,u,g,l,h-1),this.addQuad_(d,i,n,c,u,o,a,g,h-1)}return}}if(g){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&t)&&this.addTriangle_(e,n,s,r,a,l),0==(14&t)&&this.addTriangle_(e,n,i,r,a,o),t&&(0==(13&t)&&this.addTriangle_(i,s,e,o,l,r),0==(7&t))&&this.addTriangle_(i,s,n,o,l,a)}}calculateSourceExtent(){const n=[1/0,1/0,-1/0,-1/0];return this.triangles_.forEach(function(t,e,i){t=t.source;wt(n,t[0]),wt(n,t[1]),wt(n,t[2])}),n}getTriangles(){return this.triangles_}}(i,t,a,c,d*(void 0!==h?h:.5),s),0===this.triangulation_.getTriangles().length)this.state=4;else{this.sourceZ_=e.getZForResolution(d);let t=this.triangulation_.calculateSourceExtent();if(c&&(i.canWrapX()?(t[1]=R(t[1],c[1],c[3]),t[3]=R(t[3],c[1],c[3])):t=Ft(t,c)),bt(t)){const i=e.getTileRangeForExtentAndZ(t,this.sourceZ_);for(let e=i.minX;e<=i.maxX;e++)for(let t=i.minY;t<=i.maxY;t++){const i=l(this.sourceZ_,e,t,o);i&&this.sourceTiles_.push(i)}0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}}}getImage(){return this.canvas_}reproject_(){const n=[];var t,e,i,s,r;this.sourceTiles_.forEach(function(t,e,i){t&&2==t.getState()&&n.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),image:t.getImage()})}.bind(this)),(this.sourceTiles_.length=0)===n.length?this.state=3:(i=this.wrappedTileCoord_[0],t="number"==typeof(e=this.targetTileGrid_.getTileSize(i))?e:e[0],e="number"==typeof e?e:e[1],i=this.targetTileGrid_.getResolution(i),s=this.sourceTileGrid_.getResolution(this.sourceZ_),r=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),this.canvas_=function(t,e,_,p,m,i,n,s,a,r,v){const f=ce(Math.round(_*t),Math.round(_*e),fn);if(v||(f.imageSmoothingEnabled=!1),0!==s.length){f.scale(_,_),f.globalCompositeOperation="lighter";const x=[1/0,1/0,-1/0,-1/0],o=(s.forEach(function(t,e,i){var n=x;(t=t.extent)[0]<n[0]&&(n[0]=t[0]),t[2]>n[2]&&(n[2]=t[2]),t[1]<n[1]&&(n[1]=t[1]),t[3]>n[3]&&(n[3]=t[3])}),X(x)),l=K(x),C=ce(Math.round(_*o/p),Math.round(_*l/p)),h=(v||(C.imageSmoothingEnabled=!1),_/p),E=(s.forEach(function(t,e,i){var n=t.extent[0]-x[0],s=-(t.extent[3]-x[3]),r=X(t.extent),o=K(t.extent);0<t.image.width&&0<t.image.height&&C.drawImage(t.image,a,a,t.image.width-2*a,t.image.height-2*a,n*h,s*h,r*h,o*h)}),G(i));function y(t){return Math.round(t*_)/_}n.getTriangles().forEach(function(t,e,i){var n=t.source,t=t.target,s=n[0][0],r=n[0][1],o=n[1][0],a=n[1][1],l=n[2][0],n=n[2][1],h=y((t[0][0]-E[0])/m),d=y(-(t[0][1]-E[1])/m),u=y((t[1][0]-E[0])/m),c=y(-(t[1][1]-E[1])/m),g=y((t[2][0]-E[0])/m),t=y(-(t[2][1]-E[1])/m),o=function(s){const r=s.length;for(let n=0;n<r;n++){let e=n,i=Math.abs(s[n][n]);for(let t=n+1;t<r;t++){const r=Math.abs(s[t][n]);r>i&&(i=r,e=t)}if(0===i)return null;var t=s[e];s[e]=s[n],s[n]=t;for(let e=n+1;e<r;e++){var o=-s[e][n]/s[n][n];for(let t=n;t<r+1;t++)n==t?s[e][t]=0:s[e][t]+=o*s[n][t]}}var i=new Array(r);for(let e=r-1;0<=e;e--){i[e]=s[e][r]/s[e][e];for(let t=e-1;0<=t;t--)s[t][r]-=s[t][e]*i[e]}return i}([[o-=s,a-=r,0,0,u-h],[l-=s,n-=r,0,0,g-h],[0,0,o,a,c-d],[0,0,l,n,t-d]]);if(o){if(f.save(),f.beginPath(),void 0===vn&&((a=document.createElement("canvas").getContext("2d")).globalCompositeOperation="lighter",a.fillStyle="rgba(210, 0, 0, 0.75)",yn(a,4,5,4,0),yn(a,4,5,0,5),a=a.getImageData(0,0,3,3).data,vn=xn(a,0)||xn(a,4)||xn(a,8)),vn||!v){f.moveTo(u,c);const t=4,e=h-u,_=d-c;for(let t=0;t<4;t++)f.lineTo(u+y((t+1)*e/4),c+y(t*_/3)),3!=t&&f.lineTo(u+y((t+1)*e/4),c+y((t+1)*_/3))}else f.moveTo(u,c),f.lineTo(h,d);f.lineTo(g,t),f.clip(),f.transform(o[0],o[2],o[1],o[3],h,d),f.translate(x[0]-s,x[3]-r),f.scale(p/_,-p/_),f.drawImage(C.canvas,0,0),f.restore()}}),r&&(f.save(),f.globalCompositeOperation="source-over",f.strokeStyle="black",f.lineWidth=1,n.getTriangles().forEach(function(t,e,i){var t=t.target,n=(t[0][0]-E[0])/m,s=-(t[0][1]-E[1])/m,r=(t[1][0]-E[0])/m,o=-(t[1][1]-E[1])/m,a=(t[2][0]-E[0])/m,t=-(t[2][1]-E[1])/m;f.beginPath(),f.moveTo(r,o),f.lineTo(n,s),f.lineTo(a,t),f.closePath(),f.stroke()}),f.restore())}return f.canvas}(t,e,this.pixelRatio_,s,(this.sourceTileGrid_.getExtent(),i),r,this.triangulation_,n,this.gutter_,this.renderEdges_,this.interpolate),this.state=2),this.changed()}load(){if(0==this.state){this.state=1,this.changed();let s=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(i,n,t){var e=i.getState();if(0==e||1==e){s++;const n=r(i,o,function(t){var e=i.getState();2!=e&&3!=e&&4!=e||(a(n),0===--s&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(n)}}.bind(this)),0===s?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t,e,i){0==t.getState()&&t.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(a),this.sourcesListenerKeys_=null}release(){var t,e;this.canvas_&&(t=this.canvas_.getContext("2d"),(e=t.canvas).width=1,e.height=1,t.clearRect(0,0,1,1),fn.push(this.canvas_),this.canvas_=null),super.release()}};function wn(t,e,i,n){return void 0!==n?(n[0]=t,n[1]=e,n[2]=i,n):[t,e,i]}function Tn(t,e,i){return t+"/"+e+"/"+i}function Rn(t){return Tn(t[0],t[1],t[2])}const bn=class extends class{constructor(t){this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return 0<this.highWaterMark&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){t=this.entries_[t];return c(void 0!==t,15),t!==this.newest_&&(t===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(t.newer.older=t.older,t.older.newer=t.newer),t.newer=null,t.older=this.newest_,this.newest_.newer=t,this.newest_=t),t.value_}remove(t){var e=this.entries_[t];return c(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){var t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.key_;return t}getValues(){var t=new Array(this.count_);let e,i=0;for(e=this.newest_;e;e=e.older)t[i++]=e.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){if(this.containsKey(t))return this.entries_[t].value_}pop(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){c(!(t in this.entries_),16);e={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=e:this.oldest_=e,this.newest_=e,this.entries_[t]=e,++this.count_}setSize(t){this.highWaterMark=t}}{clear(){for(;0<this.getCount();)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(0!==this.getCount()){const e=this.peekFirstKey().split("/").map(Number)[0];this.forEach(function(t){t.tileCoord[0]!==e&&(this.remove(Rn(t.tileCoord)),t.release())}.bind(this))}}};function Pn(e){return e?Array.isArray(e)?function(t){return e}:"function"==typeof e?e:function(t){return[e]}:null}class Sn{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function In(t,e,i,n,s){return void 0!==s?(s.minX=t,s.maxX=e,s.minY=i,s.maxY=n,s):new Sn(t,e,i,n)}const Mn=Sn,Ln=[0,0,0],Fn=class{constructor(t){let i;if(this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,c(function(i){const n=function(t,e){return e-t};return i.every(function(t,e){return 0===e||!(0<(e=n(i[e-1],t))||0===e)})}(this.resolutions_),17),!t.origins)for(let t=0,e=this.resolutions_.length-1;t<e;++t)if(i){if(this.resolutions_[t]/this.resolutions_[t+1]!==i){i=void 0;break}}else i=this.resolutions_[t]/this.resolutions_[t+1];this.zoomFactor_=i,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,c(this.origins_.length==this.resolutions_.length,20));const n=t.extent;void 0===n||this.origin_||this.origins_||(this.origin_=G(n)),c(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,c(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:256,c(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==n?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,e){var i=new Mn(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1));if(n){const t=this.getTileRangeForExtentAndZ(n,e);i.minX=Math.max(t.minX,i.minX),i.maxX=Math.min(t.maxX,i.maxX),i.minY=Math.max(t.minY,i.minY),i.maxY=Math.min(t.maxY,i.maxY)}return i},this):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,n,s){var r=this.getTileRangeForExtentAndZ(t,n);for(let i=r.minX,t=r.maxX;i<=t;++i)for(let t=r.minY,e=r.maxY;t<=e;++t)s([n,i,t])}forEachTileCoordParentTileRange(t,e,i,n){let s,r,o,a=null,l=t[0]-1;for(2===this.zoomFactor_?(r=t[1],o=t[2]):a=this.getTileCoordExtent(t,n);l>=this.minZoom;){if(s=2===this.zoomFactor_?(r=Math.floor(r/2),o=Math.floor(o/2),In(r,r,o,o,i)):this.getTileRangeForExtentAndZ(a,l,i),e(l,s))return!0;--l}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_||this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){const i=2*t[1],n=2*t[2];return In(i,1+i,n,1+n,e)}i=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(i,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;var n=t[0],s=t[1],r=t[2];if(e===n)return In(s,r,s,r,i);if(this.zoomFactor_){const t=Math.pow(this.zoomFactor_,e-n),o=Math.floor(s*t),a=Math.floor(r*t);return e<n?In(o,o,a,a,i):In(o,Math.floor(t*(s+1))-1,a,Math.floor(t*(r+1))-1,i)}const o=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(o,e,i)}getTileRangeExtent(t,e,i){var n=this.getOrigin(t),s=this.getResolution(t),t=I(this.getTileSize(t),this.tmpSize_),r=n[0]+e.minX*t[0]*s,o=n[0]+(e.maxX+1)*t[0]*s;return g(r,n[1]+e.minY*t[1]*s,o,n[1]+(e.maxY+1)*t[1]*s,i)}getTileRangeForExtentAndZ(t,e,i){var n=Ln,s=(this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,n),n[1]),r=n[2];return this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,n),In(s,n[1],r,n[2],i)}getTileCoordCenter(t){var e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=I(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){var i=this.getOrigin(t[0]),n=this.getResolution(t[0]),s=I(this.getTileSize(t[0]),this.tmpSize_),r=i[0]+t[1]*s[0]*n,i=i[1]-(t[2]+1)*s[1]*n;return g(r,i,r+s[0]*n,i+s[1]*n,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,s){var r=this.getZForResolution(i),o=i/this.getResolution(r),a=this.getOrigin(r),l=I(this.getTileSize(r),this.tmpSize_);let h=o*(t-a[0])/i/l[0],d=o*(a[1]-e)/i/l[1];return d=n?(h=Nt(h,5)-1,Nt(d,5)-1):(h=jt(h,5),jt(d,5)),wn(r,h,d,s)}getTileCoordForXYAndZ_(t,e,i,n,s){var r=this.getOrigin(i),o=this.getResolution(i),a=I(this.getTileSize(i),this.tmpSize_);let l=(t-r[0])/o/a[0],h=(r[1]-e)/o/a[1];return h=n?(l=Nt(l,5)-1,Nt(h,5)-1):(l=jt(l,5),jt(h,5)),wn(i,l,h,s)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_||this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){return R(T(this.resolutions_,t,e||0),this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Si(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(e){var i=this.resolutions_.length,n=new Array(i);for(let t=this.minZoom;t<i;++t)n[t]=this.getTileRangeForExtentAndZ(e,t);this.fullTileRanges_=n}};function An(t){let e=t.getDefaultTileGrid();return e||(e=(i=On(t),n=zn(i,void 0,void 0),new Fn({extent:i,origin:function(t,e){let i;return"bottom-left"===e?i=Pt(t):"bottom-right"===e?i=St(t):"top-left"===e?i=G(t):"top-right"===e?i=At(t):c(!1,13),i}(i,"top-left"),resolutions:n,tileSize:void 0})),t.setDefaultTileGrid(e)),e;var i,n}function zn(t,e,i,n){e=void 0!==e?e:42,i=I(void 0!==i?i:256);var s=K(t),t=X(t),r=(n=0<n?n:Math.max(t/i[0],s/i[1]),e+1),o=new Array(r);for(let t=0;t<r;++t)o[t]=n/Math.pow(2,t);return o}function On(t){let e=(t=E(t)).getExtent();return e||(t=180*Ie.degrees/t.getMetersPerUnit(),e=g(-t,-t,t,t)),e}class Dn extends t{constructor(t,e){super(t),this.tile=e}}y=class extends class extends e{constructor(t){super(),this.projection=E(t.projection),this.attributions_=Pn(t.attributions),this.attributionsCollapsible_=void 0===t.attributionsCollapsible||t.attributionsCollapsible,this.loading=!1,this.state_=void 0!==t.state?t.state:"ready",this.wrapX_=void 0!==t.wrapX&&t.wrapX,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const i=this;this.viewPromise_=new Promise(function(t,e){i.viewResolver=t,i.viewRejector=e})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(){return l()}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Pn(t),this.changed()}setState(t){this.state_=t,this.changed()}}{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null,this.tileGrid&&I(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new bn(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection||0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){t=this.getTileCacheForProjection(t);t&&t.expireCache(e)}forEachLoadedTile(t,i,n,s){var r=this.getTileCacheForProjection(t);if(!r)return!1;let o,a,l,h=!0;for(let e=n.minX;e<=n.maxX;++e)for(let t=n.minY;t<=n.maxY;++t)a=Tn(i,e,t),l=!1,r.containsKey(a)&&(o=r.get(a),l=(l=2===o.getState())&&!1!==s(o)),l||(h=!1);return h}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(){return this.tileGrid?this.tileGrid.getResolutions():null}getTile(t,e,i,n,s){return l()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid||An(t)}getTileCacheForProjection(t){var e=this.getProjection();return c(null===e||$e(e,t),68),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){var i=this.getTileGridForProjection(i),e=this.getTilePixelRatio(e),i=I(i.getTileSize(t),this.tmpSize);return 1==e?i:((t=void 0===(t=this.tmpSize)?[0,0]:t)[0]=(i=i)[0]*(e=e)+.5|0,t[1]=i[1]*e+.5|0,t)}getTileCoordForTileUrlFunction(t,e){e=void 0!==e?e:this.getProjection();var i=this.getTileGridForProjection(e);return function(t,e){var i=t[0],n=t[1],t=t[2];if(!(e.getMinZoom()>i||i>e.getMaxZoom()))return!(e=e.getFullTileRange(i))||e.containsXY(n,t)}(t=this.getWrapX()&&e.isGlobal()?function(t,e,i){var n=e[0],s=t.getTileCoordCenter(e),r=On(i);if(ft(r,s))return e;{const e=X(r),i=Math.ceil((r[0]-s[0])/e);return s[0]+=e*i,t.getTileCoordForCoordAndZ(s,n)}}(i,t,e):t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){e=this.getTileCacheForProjection(e);t>e.highWaterMark&&(e.highWaterMark=t)}useTile(t,e,i,n){}};function kn(t,e){t.getImage().src=e}const jn=class extends class $n extends y{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===$n.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){var e=N(t=t.target),i=t.getState();let n;1==i?(this.tileLoadingKeys_[e]=!0,n="tileloadstart"):e in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[e],n=3==i?"tileloaderror":2==i?"tileloadend":void 0),null!=n&&this.dispatchEvent(new Dn(n,t))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()}setUrl(t){t=function(e){var i=[];let n=/\{([a-z])-([a-z])\}/.exec(e);if(n){var s=n[1].charCodeAt(0),r=n[2].charCodeAt(0);let t;for(t=s;t<=r;++t)i.push(e.replace(n[0],String.fromCharCode(t)))}else if(n=/\{(\d+)-(\d+)\}/.exec(e)){var o=parseInt(n[2],10);for(let t=parseInt(n[1],10);t<=o;t++)i.push(e.replace(n[0],t.toString()))}else i.push(e);return i}(t),this.urls=t,this.setUrls(t)}setUrls(t){var e=(this.urls=t).join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(e,i){var s,n=e.length,r=new Array(n);for(let t=0;t<n;++t)r[t]=function(n,s){const r=/\{z\}/g,o=/\{x\}/g,a=/\{y\}/g,l=/\{-y\}/g;return function(e,t,i){return e?n.replace(r,e[0].toString()).replace(o,e[1].toString()).replace(a,e[2].toString()).replace(l,function(){var t=e[0];return c(t=s.getFullTileRange(t),55),(t.getHeight()-e[2]-1).toString()}):void 0}}(e[t],i);return 1===(s=r).length?s[0]:function(t,e,i){var n;if(t)return n=m((t[1]<<t[0])+t[2],s.length),s[n](t,e,i)}}(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){t=Tn(t,e,i),this.tileCache.containsKey(t)&&this.tileCache.get(t)}}{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction||kn,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:void 0===t.interpolate||t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:mn,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){var i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const t in this.tileCacheForProjection){var n=this.tileCacheForProjection[t];n.expireCache(n==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!$e(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return!(this.getProjection()&&t&&!$e(this.getProjection(),t))&&super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(!this.tileGrid||e&&!$e(e,t)){const e=N(t);return e in this.tileGridForProjection||(this.tileGridForProjection[e]=An(t)),this.tileGridForProjection[e]}return this.tileGrid}getTileCacheForProjection(t){const e=this.getProjection();if(!e||$e(e,t))return this.tileCache;{const e=N(t);return e in this.tileCacheForProjection||(this.tileCacheForProjection[e]=new bn(this.tileCache.highWaterMark)),this.tileCacheForProjection[e]}}createTile_(t,e,i,n,s,r){t=[t,e,i],e=this.getTileCoordForTileUrlFunction(t,s),i=e?this.tileUrlFunction(e,n,s):void 0,e=new this.tileClass(t,void 0!==i?0:4,void 0!==i?i:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return e.key=r,e.addEventListener(o,this.handleTileChange.bind(this)),e}getTile(e,i,n,s,r){const o=this.getProjection();if(o&&r&&!$e(o,r)){var a=this.getTileCacheForProjection(r),l=[e,i,n];let t;var h=Rn(l),d=(a.containsKey(h)&&(t=a.get(h)),this.getKey());if(t&&t.key==d)return t;{const e=this.getTileGridForProjection(o),i=this.getTileGridForProjection(r),n=this.getTileCoordForTileUrlFunction(l,r),u=new En(o,e,r,i,l,n,this.getTilePixelRatio(s),this.getGutter(),function(t,e,i,n){return this.getTileInternal(t,e,i,n,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return u.key=d,t?(u.interimTile=t,u.refreshInterimChain(),a.replace(h,u)):a.set(h,u),u}}return this.getTileInternal(e,i,n,s,o||r)}getTileInternal(t,e,i,n,s){let r=null;var o,a=Tn(t,e,i),l=this.getKey();return this.tileCache.containsKey(a)?(r=this.tileCache.get(a)).key!=l&&(o=r,r=this.createTile_(t,e,i,n,s,l),0==o.getState()?r.interimTile=o.interimTile:r.interimTile=o,r.refreshInterimChain(),this.tileCache.replace(a,r)):(r=this.createTile_(t,e,i,n,s,l),this.tileCache.set(a,r)),r}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear();this.changed()}}setTileGridForProjection(t,e){var i=E(t);if(i){const t=N(i);t in this.tileGridForProjection||(this.tileGridForProjection[t]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}},Nn=class extends jn{constructor(t){const e=void 0!==(t=t||{}).projection?t.projection:"EPSG:3857",i=void 0!==t.tileGrid?t.tileGrid:(n={extent:On(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize},s={extent:s=n.extent||E("EPSG:3857").getExtent(),minZoom:n.minZoom,tileSize:n.tileSize,resolutions:zn(s,n.maxZoom,n.tileSize,n.maxResolution)},new Fn(s));var n,s;super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=void 0!==t.gutter?t.gutter:0}getGutter(){return this.gutter_}},Zn=class extends Nn{constructor(t){var e=void 0!==(t=t||{}).attributions?t.attributions:['&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.'],i=void 0!==t.crossOrigin?t.crossOrigin:"anonymous",n=void 0!==t.url?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:i,interpolate:t.interpolate,maxZoom:void 0!==t.maxZoom?t.maxZoom:19,opaque:void 0===t.opaque||t.opaque,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:n,wrapX:t.wrapX,zDirection:t.zDirection})}},Kn="preload",Gn="useInterimTilesOnError",Xn=class extends se{constructor(t){t=t||{};var e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(void 0!==t.preload?t.preload:0),this.setUseInterimTilesOnError(void 0===t.useInterimTilesOnError||t.useInterimTilesOnError)}getPreload(){return this.get(Kn)}setPreload(t){this.set(Kn,t)}getUseInterimTilesOnError(){return this.get(Gn)}setUseInterimTilesOnError(t){this.set(Gn,t)}getData(t){return super.getData(t)}},Un=class extends ${constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return l()}getData(t){return null}prepareFrame(t){return l()}renderFrame(t,e){return l()}loadedTileCallback(t,e,i){t[e]||(t[e]={}),t[e][i.tileCoord.toString()]=i}createLoadedTileFinder(n,s,r){return function(t,e){var i=this.loadedTileCallback.bind(this,r,t);return n.forEachLoadedTile(s,t,e,i)}.bind(this)}forEachFeatureAtCoordinate(t,e,i,n,s){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){2===t.target.getState()&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return 2!=e&&3!=e&&t.addEventListener(o,this.boundHandleImageChange_),0==e&&(t.load(),e=t.getState()),2==e}renderIfReadyAndVisible(){var t=this.getLayer();t&&t.getVisible()&&"ready"===t.getSourceState()&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}};let Vn=null;const Wn=class extends Un{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=[1,0,0,1,0,0],this.pixelTransform=[1,0,0,1,0,0],this.inversePixelTransform=[1,0,0,1,0,0],this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,i){let n;var s;Vn||((s=document.createElement("canvas")).width=1,s.height=1,Vn=s.getContext("2d")),Vn.clearRect(0,0,1,1);try{Vn.drawImage(t,e,i,1,1,0,0,1,1),n=Vn.getImageData(0,0,1,1).data}catch(t){return Vn=null}return n}getBackground(t){let e=this.getLayer().getBackground();return(e="function"==typeof e?e(t.viewState.resolution):e)||void 0}useContainer(t,e,i){var n=this.getLayer().getClassName();let s,r;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&F(Xt(t.style.backgroundColor),Xt(i)))){const e=t.firstElementChild;e instanceof HTMLCanvasElement&&(r=e.getContext("2d"))}if(r&&r.canvas.style.transform===e?(this.container=t,this.context=r,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(s=document.createElement("div")).className=n;let t=s.style;t.position="absolute",t.width="100%",t.height="100%";const e=(r=ce()).canvas;s.appendChild(e),(t=e.style).position="absolute",t.left="0",t.transformOrigin="top left",this.container=s,this.context=r}this.containerReused||!i||this.container.style.backgroundColor||(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){var n=G(i),s=At(i),r=St(i),i=Pt(i),e=(Z(e.coordinateToPixelTransform,n),Z(e.coordinateToPixelTransform,s),Z(e.coordinateToPixelTransform,r),Z(e.coordinateToPixelTransform,i),this.inversePixelTransform);Z(e,n),Z(e,s),Z(e,r),Z(e,i),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.clip()}dispatchRenderEvent_(t,e,i){var n=this.getLayer();n.hasListener(t)&&(t=new he(t,this.inversePixelTransform,i,e),n.dispatchEvent(t))}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_("prerender",t,e)}postRender(t,e){this.dispatchRenderEvent_("postrender",t,e)}getRenderTransform(t,e,i,n,s,r,o){n/=e,e=-t[0]+o,o=-t[1];return gt(this.tempTransform,s/2,r/2,n,-n,-i,e,o)}disposeInternal(){delete this.frameState,super.disposeInternal()}},Yn=class extends Wn{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=[1/0,1/0,-1/0,-1/0],this.tmpTileRange_=new Mn(0,0,0,0)}isDrawableTile(t){var e=this.getLayer(),t=t.getState(),e=e.getUseInterimTilesOnError();return 2==t||4==t||3==t&&!e}getTile(t,e,i,n){var s=n.pixelRatio,n=n.viewState.projection,r=this.getLayer();let o=r.getSource().getTile(t,e,i,s,n);return 3==o.getState()&&r.getUseInterimTilesOnError()&&0<r.getPreload()&&(this.newTiles_=!0),o=this.isDrawableTile(o)?o:o.getInterimTile()}getData(t){const e=this.frameState;if(e){const l=this.getLayer(),h=Z(e.pixelToCoordinateTransform,t.slice()),d=l.getExtent();if(!d||ft(d,h)){var i=e.pixelRatio,n=e.viewState.projection,s=e.viewState,r=l.getRenderSource(),o=r.getTileGridForProjection(s.projection),a=r.getTilePixelRatio(e.pixelRatio);for(let t=o.getZForResolution(s.resolution);t>=o.getMinZoom();--t){const e=o.getTileCoordForCoordAndZ(h,t),l=r.getTile(t,e[1],e[2],i,n);if(!(l instanceof mn||l instanceof En)||l instanceof En&&4===l.getState())return null;if(2===l.getState()){const d=o.getOrigin(t),u=I(o.getTileSize(t)),c=o.getResolution(t),g=Math.floor(a*((h[0]-d[0])/c-e[1]*u[0])),_=Math.floor(a*((d[1]-h[1])/c-e[2]*u[1])),p=Math.round(a*r.getGutterForProjection(s.projection));return this.getImageData(l.getImage(),g+p,_+p)}}}}return null}loadedTileCallback(t,e,i){return!!this.isDrawableTile(i)&&super.loadedTileCallback(t,e,i)}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(n,s){const r=n.layerStatesArray[n.layerIndex],o=n.viewState,a=o.projection,e=o.resolution,l=o.center,h=o.rotation,d=n.pixelRatio,u=this.getLayer(),c=u.getSource(),g=c.getRevision(),_=c.getTileGridForProjection(a),p=_.getZForResolution(e,c.zDirection),m=_.getResolution(p);let v=n.extent;const f=n.viewState.resolution,y=c.getTilePixelRatio(d),x=Math.round(X(v)/f*d),C=Math.round(K(v)/f*d),E=r.extent&&r.extent,w=(E&&(v=Ft(v,r.extent)),m*x/2/y),t=m*C/2/y,i=[l[0]-w,l[1]-t,l[0]+w,l[1]+t],T=_.getTileRangeForExtentAndZ(v,p),R={};R[p]={};var b=this.createLoadedTileFinder(c,a,R),P=this.tmpExtent,D=this.tmpTileRange_,k=(this.newTiles_=!1,h?Lt(o.center,f,h,n.size):void 0);for(let i=T.minX;i<=T.maxX;++i)for(let e=T.minY;e<=T.maxY;++e)if(!h||_.tileCoordIntersectsViewport([p,i,e],k)){const o=this.getTile(p,i,e,n);if(this.isDrawableTile(o)){const s=N(this);if(2==o.getState()){let t=(R[p][o.tileCoord.toString()]=o).inTransition(s);t&&1!==r.opacity&&(o.endTransition(s),t=!1),this.newTiles_||!t&&this.renderedTiles.includes(o)||(this.newTiles_=!0)}if(1===o.getAlpha(s,n.time))continue}const a=_.getTileCoordChildTileRange(o.tileCoord,D,P);let t=!1;(t=a?b(p+1,a):t)||_.forEachTileCoordParentTileRange(o.tileCoord,b,D,P)}var S=m/e*d/y,I=(gt(this.pixelTransform,n.size[0]/2,n.size[1]/2,1/d,1/d,h,-x/2,-C/2),I="matrix("+(I=this.pixelTransform).join(", ")+")",dt?I:((L=pt=pt||document.createElement("div")).style.transform=I,L.style.transform)),M=(this.useContainer(s,I,this.getBackground(n)),this.context),L=M.canvas;_t(this.inversePixelTransform,this.pixelTransform),gt(this.tempTransform,x/2,C/2,S,S,0,-x/2,-C/2),L.width!=x||L.height!=C?(L.width=x,L.height=C):this.containerReused||M.clearRect(0,0,x,C),E&&this.clipUnrotated(M,n,E),c.getInterpolate()||(M.imageSmoothingEnabled=!1),this.preRender(M,n),this.renderedTiles.length=0;let F,A,z,O=Object.keys(R).map(Number);O.sort(j),1!==r.opacity||this.containerReused&&!c.getOpaque(n.viewState.projection)?(F=[],A=[]):O=O.reverse();for(let t=O.length-1;0<=t;--t){const r=O[t],j=c.getTilePixelSize(r,d,a),o=_.getResolution(r)/m,e=j[0]*o*S,l=j[1]*o*S,h=_.getTileCoordForCoordAndZ(G(i),r),u=_.getTileCoordExtent(h),g=Z(this.tempTransform,[y*(u[0]-i[0])/m,y*(i[3]-u[3])/m]),v=y*c.getGutterForProjection(a),f=R[r];for(const s in f){const j=f[s],o=j.tileCoord,a=h[1]-o[1],d=Math.round(g[0]-(a-1)*e),u=h[2]-o[2],_=Math.round(g[1]-(u-1)*l),m=Math.round(g[0]-a*e),y=Math.round(g[1]-u*l),x=d-m,C=_-y,E=p===r,w=E&&1!==j.getAlpha(N(this),n.time);let i=!1;if(!w)if(F){z=[m,y,m+x,y,m+x,y+C,m,y+C];for(let t=0,e=F.length;t<e;++t)if(p!==r&&r<A[t]){const s=F[t];zt([m,y,m+x,y+C],[s[0],s[3],s[4],s[7]])&&(i||(M.save(),i=!0),M.beginPath(),M.moveTo(z[0],z[1]),M.lineTo(z[2],z[3]),M.lineTo(z[4],z[5]),M.lineTo(z[6],z[7]),M.moveTo(s[6],s[7]),M.lineTo(s[4],s[5]),M.lineTo(s[2],s[3]),M.lineTo(s[0],s[1]),M.clip())}F.push(z),A.push(r)}else M.clearRect(m,y,x,C);this.drawTileImage(j,n,m,y,x,C,v,E),F&&!w?(i&&M.restore(),this.renderedTiles.unshift(j)):this.renderedTiles.push(j),this.updateUsedTiles(n.usedTiles,c,j)}}return this.renderedRevision=g,this.renderedResolution=m,this.extentChanged=!this.renderedExtent_||!Et(this.renderedExtent_,i),this.renderedExtent_=i,this.renderedPixelRatio=d,this.renderedProjection=a,this.manageTilePyramid(n,c,_,d,a,v,p,u.getPreload()),this.scheduleExpireCache(n,c),this.postRender(M,n),r.extent&&M.restore(),M.imageSmoothingEnabled=!0,I!==L.style.transform&&(L.style.transform=I),this.container}drawTileImage(t,e,i,n,s,r,o,a){var l,h,d,u,c=this.getTileImage(t);c&&(l=N(this),(u=(d=(h=e.layerStatesArray[e.layerIndex]).opacity*(a?t.getAlpha(l,e.time):1))!==this.context.globalAlpha)&&(this.context.save(),this.context.globalAlpha=d),this.context.drawImage(c,o,o,c.width-2*o,c.height-2*o,i,n,s,r),u&&this.context.restore(),d!==h.opacity?e.animate=!0:a&&t.endTransition(l))}getImage(){var t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){e.canExpireCache()&&(e=function(t,e,i){var n=N(t);n in i.usedTiles&&t.expireCache(i.viewState.projection,i.usedTiles[n])}.bind(null,e),t.postRenderFunctions.push(e))}updateUsedTiles(t,e,i){e=N(e);e in t||(t[e]={}),t[e][i.getKey()]=!0}manageTilePyramid(t,e,i,n,s,r,o,a,l){var h=N(e),d=(h in t.wantedTiles||(t.wantedTiles[h]={}),t.wantedTiles[h]),u=t.tileQueue,c=i.getMinZoom(),g=t.viewState.rotation,_=g?Lt(t.viewState.center,t.viewState.resolution,g,t.size):void 0;let p,m,v,f,y,x,C=0;for(x=c;x<=o;++x)for(m=i.getTileRangeForExtentAndZ(r,x,m),v=i.getResolution(x),f=m.minX;f<=m.maxX;++f)for(y=m.minY;y<=m.maxY;++y)g&&!i.tileCoordIntersectsViewport([x,f,y],_)||(o-x<=a?(++C,0==(p=e.getTile(x,f,y,n,s)).getState()&&(d[p.getKey()]=!0,u.isKeyQueued(p.getKey())||u.enqueue([p,h,i.getTileCoordCenter(p.tileCoord),v])),void 0!==l&&l(p)):e.useTile(x,f,y,s));e.updateCacheSize(C,s)}},qn=class extends Xn{constructor(t){super(t)}createRenderer(){return new Yn(this)}};document.addEventListener("DOMContentLoaded",()=>{console.log("Script loaded"),new _n({target:"map",layers:[new qn({source:new Zn})],view:new S({center:[0,0],zoom:2})})})})();